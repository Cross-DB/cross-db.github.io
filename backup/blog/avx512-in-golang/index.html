<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="High Performance Embedded Database Development Platform"><meta name=author content=CrossDB><link href=https://crossdb.org/backup/blog/avx512-in-golang/ rel=canonical><link rel=icon href=../../../assets/favicon.png><meta name=generator content="mkdocs-1.4.3, mkdocs-material-9.1.11"><title>How to Use AVX512 in Golang via C Compiler - CrossDB</title><link rel=stylesheet href=../../../assets/stylesheets/main.85bb2934.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.a6bdf11c.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../assets/style/extra.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-VPTG3S10X7"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-VPTG3S10X7",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-VPTG3S10X7",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=light-blue> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#how-to-use-avx512-in-golang-via-c-compiler class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=CrossDB class="md-header__button md-logo" aria-label=CrossDB data-md-component=logo> <img src=../../../assets/favicon.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> CrossDB </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> How to Use AVX512 in Golang via C Compiler </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=light-blue aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/cross-db/crossdb title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> CrossDB </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../products/products/ class=md-tabs__link> Products </a> </li> <li class=md-tabs__item> <a href=../../../docs/introduction/ class=md-tabs__link> Document </a> </li> <li class=md-tabs__item> <a href=../../../about/about/ class=md-tabs__link> About </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=CrossDB class="md-nav__button md-logo" aria-label=CrossDB data-md-component=logo> <img src=../../../assets/favicon.png alt=logo> </a> CrossDB </label> <div class=md-nav__source> <a href=https://github.com/cross-db/crossdb title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> CrossDB </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> Products <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Products </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../products/products/ class=md-nav__link> Products </a> </li> <li class=md-nav__item> <a href=../../../products/download/ class=md-nav__link> Download </a> </li> <li class=md-nav__item> <a href=../../../products/CHANGELOG/ class=md-nav__link> Change Log </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> Document <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Document </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../docs/introduction/ class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../../../docs/get-started/ class=md-nav__link> Get Started </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0> Embedded RDBMS <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Embedded RDBMS </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../docs/crossdb/database/ class=md-nav__link> Database </a> </li> <li class=md-nav__item> <a href=../../../docs/crossdb/schema/ class=md-nav__link> Schema </a> </li> <li class=md-nav__item> <a href=../../../docs/crossdb/table/ class=md-nav__link> Table </a> </li> <li class=md-nav__item> <a href=../../../docs/crossdb/indexes/ class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../docs/crossdb/dml/ class=md-nav__link> Data Manipulation Guide </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4 id=__nav_3_4_label tabindex=0> API Reference <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> API Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../docs/api/api/ class=md-nav__link> API List </a> </li> <li class=md-nav__item> <a href=../../../docs/api/ddl/ class=md-nav__link> Database Definition APIs </a> </li> <li class=md-nav__item> <a href=../../../docs/api/dml/ class=md-nav__link> Database Manipulation APIs </a> </li> <li class=md-nav__item> <a href=../../../docs/api/misc/ class=md-nav__link> Misc APIs </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> About <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> About </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../about/about/ class=md-nav__link> About US </a> </li> <li class=md-nav__item> <a href=../../../about/community/ class=md-nav__link> Community </a> </li> <li class=md-nav__item> <a href=../../../about/faq/ class=md-nav__link> FAQ </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#compile-assembly-from-c class=md-nav__link> Compile Assembly from C </a> </li> <li class=md-nav__item> <a href=#construct-go-code-from-assembly class=md-nav__link> Construct Go Code from Assembly </a> <nav class=md-nav aria-label="Construct Go Code from Assembly"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#convert-assembly class=md-nav__link> Convert Assembly </a> <nav class=md-nav aria-label="Convert Assembly"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#encoding-machine-code class=md-nav__link> Encoding Machine Code </a> </li> <li class=md-nav__item> <a href=#function-definition-and-parameters class=md-nav__link> Function Definition and Parameters </a> </li> <li class=md-nav__item> <a href=#redirect-jump-instruction class=md-nav__link> Redirect Jump Instruction </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#generate-go-function-definitions class=md-nav__link> Generate Go Function Definitions </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#build-with-go-generate class=md-nav__link> Build with go generate </a> </li> <li class=md-nav__item> <a href=#function-calls class=md-nav__link> Function Calls </a> </li> <li class=md-nav__item> <a href=#summary class=md-nav__link> Summary </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=how-to-use-avx512-in-golang-via-c-compiler>How to Use AVX512 in Golang via C Compiler<a class=headerlink href=#how-to-use-avx512-in-golang-via-c-compiler title="Permanent link">&para;</a></h1> <p>AVX512 is the latest generation of SIMD instructions released by Intel, which can process 512 bits of data in one instruction cycle, equivalent to 16 single-precision floating point numbers or 8 double-precision floating point numbers. The training and inference process of recommendation models in <a href=https://gorse.io/ >Gorse</a> requires a lot of vector computation, and AVX512 can theoretically bring some acceleration effect. Unfortunately, the Go compiler does not automatically generate SIMD instructions.</p> <p><a href=https://github.com/minio>MinIO</a> had open-sourced a tool to convert Intel assembly to Go assembly <a href=https://github.com/minio/c2goasm>c2goasm</a>. First, the vectorized functions are implemented in C, and the assembly containing the SIMD instructions is compiled by Clang. Then, since <a href=https://go.dev/doc/asm>Go assembly</a> <a href=https://github.com/golang/go/wiki/AVX512>supports AVX512</a>, the functions implemented by SIMD can be called through Go assembly. The c2goasm solution is very effective, however, the project has not been updated for almost 4 years, and after testing it cannot handle AVX512 instructions.</p> <p>To use AVX512 in Go, we have developed a toolkit for compiling C into Go assembly functions <a href=https://github.com/gorse-io/gorse/tree/master/cmd/goat>goat</a> and implemented a library of vectorized functions with the help of goat <a href=https://github.com/gorse-io/gorse/tree/master/base/floats>github.com/gorse-io/gorse/base/floats</a>. Inheriting the idea of c2goasm, <code>goat</code> implements further enhancements.</p> <ol> <li>Starting directly from the C source code to get Go assembly functions, the user does not have to compile the C source code itself.</li> <li>It will also generate Go function definitions based on C function definitions, so users do not need to write Go function definitions by hand.</li> </ol> <p>The post will detail the technical implementation of goat ideas, welcome to read the code <a href=https://github.com/gorse-io/gorse/tree/master/cmd/goat>github.com/gorse-io/gorse/cmd/goat</a>.</p> <pre class=mermaid><code>flowchart LR
  c[C source]--&gt;intel[Intel assembly]
  intel--&gt;goasm[Go assembly]
  c--&gt;go[Go function definition]</code></pre> <h2 id=compile-assembly-from-c>Compile Assembly from C<a class=headerlink href=#compile-assembly-from-c title="Permanent link">&para;</a></h2> <p>The C implementation of the function <code>_mm512_mul_to</code> multiplies two floating point arrays and then saves the result in a third array. In general, the compiler automatically generates assembly that uses SIMD. Here, intrinsic is used to ensure that SIMD instructions are generated.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;immintrin.h&gt;</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=kt>void</span><span class=w> </span><span class=nf>_mm512_mul_to</span><span class=p>(</span><span class=kt>float</span><span class=w> </span><span class=o>*</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>float</span><span class=w> </span><span class=o>*</span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=kt>float</span><span class=w> </span><span class=o>*</span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=kt>int64_t</span><span class=w> </span><span class=n>n</span><span class=p>)</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=p>{</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>epoch</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>16</span><span class=p>;</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>remain</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>16</span><span class=p>;</span>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>epoch</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=w>    </span><span class=p>{</span>
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=w>        </span><span class=n>__m512</span><span class=w> </span><span class=n>v1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_mm512_loadu_ps</span><span class=p>(</span><span class=n>a</span><span class=p>);</span>
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=w>        </span><span class=n>__m512</span><span class=w> </span><span class=n>v2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_mm512_loadu_ps</span><span class=p>(</span><span class=n>b</span><span class=p>);</span>
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=w>        </span><span class=n>__m512</span><span class=w> </span><span class=n>v</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_mm512_mul_ps</span><span class=p>(</span><span class=n>v1</span><span class=p>,</span><span class=w> </span><span class=n>v2</span><span class=p>);</span>
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=w>        </span><span class=n>_mm512_storeu_ps</span><span class=p>(</span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>v</span><span class=p>);</span>
<a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=w>        </span><span class=n>a</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>16</span><span class=p>;</span>
<a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=w>        </span><span class=n>b</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>16</span><span class=p>;</span>
<a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=w>        </span><span class=n>c</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>16</span><span class=p>;</span>
<a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>remain</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>8</span><span class=p>)</span>
<a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=w>    </span><span class=p>{</span>
<a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a><span class=w>        </span><span class=n>__m256</span><span class=w> </span><span class=n>v1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_mm256_loadu_ps</span><span class=p>(</span><span class=n>a</span><span class=p>);</span>
<a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a><span class=w>        </span><span class=n>__m256</span><span class=w> </span><span class=n>v2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_mm256_loadu_ps</span><span class=p>(</span><span class=n>b</span><span class=p>);</span>
<a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a><span class=w>        </span><span class=n>__m256</span><span class=w> </span><span class=n>v</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_mm256_mul_ps</span><span class=p>(</span><span class=n>v1</span><span class=p>,</span><span class=w> </span><span class=n>v2</span><span class=p>);</span>
<a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a><span class=w>        </span><span class=n>_mm256_storeu_ps</span><span class=p>(</span><span class=n>c</span><span class=p>,</span><span class=w> </span><span class=n>v</span><span class=p>);</span>
<a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a><span class=w>        </span><span class=n>a</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>8</span><span class=p>;</span>
<a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a><span class=w>        </span><span class=n>b</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>8</span><span class=p>;</span>
<a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a><span class=w>        </span><span class=n>c</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>8</span><span class=p>;</span>
<a id=__codelineno-0-26 name=__codelineno-0-26 href=#__codelineno-0-26></a><span class=w>        </span><span class=n>remain</span><span class=w> </span><span class=o>-=</span><span class=w> </span><span class=mi>8</span><span class=p>;</span>
<a id=__codelineno-0-27 name=__codelineno-0-27 href=#__codelineno-0-27></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-0-28 name=__codelineno-0-28 href=#__codelineno-0-28></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>remain</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span>
<a id=__codelineno-0-29 name=__codelineno-0-29 href=#__codelineno-0-29></a><span class=w>    </span><span class=p>{</span>
<a id=__codelineno-0-30 name=__codelineno-0-30 href=#__codelineno-0-30></a><span class=w>        </span><span class=n>c</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
<a id=__codelineno-0-31 name=__codelineno-0-31 href=#__codelineno-0-31></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-0-32 name=__codelineno-0-32 href=#__codelineno-0-32></a><span class=p>}</span>
</code></pre></div> <p>Save the code to <code>mm512_mul_to.c</code> and use the following command to compile the C code to assembly as well as binary.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c1># Generate assembly</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>clang<span class=w> </span>-S<span class=w> </span>-c<span class=w> </span>mm512_mul_to.c<span class=w> </span>-o<span class=w> </span>mm512_mul_to.s<span class=w> </span><span class=se>\</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=w>  </span>-O3<span class=w> </span>-mavx<span class=w> </span>-mfma<span class=w> </span>-mavx512f<span class=w> </span>-mavx512dq<span class=w> </span><span class=se>\</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=w>  </span>-mno-red-zone<span class=w> </span>-mstackrealign<span class=w> </span>-mllvm<span class=w> </span>-inline-threshold<span class=o>=</span><span class=m>1000</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=w>  </span>-fno-asynchronous-unwind-tables<span class=w> </span>-fno-exceptions<span class=w> </span>-fno-rtti
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=c1># Generate binary</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>clang<span class=w> </span>-c<span class=w> </span>mm512_mul_to.c<span class=w> </span>-o<span class=w> </span>mm512_mul_to.o<span class=w> </span><span class=se>\</span>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=w>  </span>-O3<span class=w> </span>-mavx<span class=w> </span>-mfma<span class=w> </span>-mavx512f<span class=w> </span>-mavx512dq<span class=w> </span><span class=se>\</span>
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=w>  </span>-mno-red-zone<span class=w> </span>-mstackrealign<span class=w> </span>-mllvm<span class=w> </span>-inline-threshold<span class=o>=</span><span class=m>1000</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=w>  </span>-fno-asynchronous-unwind-tables<span class=w> </span>-fno-exceptions<span class=w> </span>-fno-rtti
</code></pre></div> <p>::: details mm512_mul_to.s</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=w> </span><span class=na>.globl</span><span class=w> </span><span class=no>_mm512_mul_to</span><span class=w>                   </span><span class=c1># -- Begin function _mm512_mul_to</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=w> </span><span class=na>.p2align</span><span class=w> </span><span class=mi>4</span><span class=p>,</span><span class=w> </span><span class=mi>0x90</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=w> </span><span class=na>.type</span><span class=w> </span><span class=no>_mm512_mul_to</span><span class=p>,</span><span class=na>@function</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=nl>_mm512_mul_to:</span><span class=w>                          </span><span class=c1># @_mm512_mul_to</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=c1># %bb.0:</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=w> </span><span class=nf>pushq</span><span class=w> </span><span class=nv>%rbp</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=w> </span><span class=nf>movq</span><span class=w> </span><span class=nv>%rsp</span><span class=p>,</span><span class=w> </span><span class=nv>%rbp</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=w> </span><span class=nf>andq</span><span class=w> </span><span class=no>$-8</span><span class=p>,</span><span class=w> </span><span class=nv>%rsp</span>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=w> </span><span class=nf>leaq</span><span class=w> </span><span class=mi>15</span><span class=p>(</span><span class=nv>%rcx</span><span class=p>),</span><span class=w> </span><span class=nv>%r9</span>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=w> </span><span class=nf>testq</span><span class=w> </span><span class=nv>%rcx</span><span class=p>,</span><span class=w> </span><span class=nv>%rcx</span>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=w> </span><span class=nf>cmovnsq</span><span class=w> </span><span class=nv>%rcx</span><span class=p>,</span><span class=w> </span><span class=nv>%r9</span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=w> </span><span class=nf>shrq</span><span class=w> </span><span class=no>$4</span><span class=p>,</span><span class=w> </span><span class=nv>%r9</span>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=w> </span><span class=nf>movl</span><span class=w> </span><span class=nv>%r9d</span><span class=p>,</span><span class=w> </span><span class=nv>%eax</span>
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=w> </span><span class=nf>shll</span><span class=w> </span><span class=no>$4</span><span class=p>,</span><span class=w> </span><span class=nv>%eax</span>
<a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=w> </span><span class=nf>subl</span><span class=w> </span><span class=nv>%eax</span><span class=p>,</span><span class=w> </span><span class=nv>%ecx</span>
<a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a><span class=w> </span><span class=nf>testl</span><span class=w> </span><span class=nv>%r9d</span><span class=p>,</span><span class=w> </span><span class=nv>%r9d</span>
<a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a><span class=w> </span><span class=nf>jle</span><span class=w> </span><span class=no>.LBB3_6</span>
<a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a><span class=c1># %bb.1:</span>
<a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a><span class=w> </span><span class=nf>leal</span><span class=w> </span><span class=mi>-1</span><span class=p>(</span><span class=nv>%r9</span><span class=p>),</span><span class=w> </span><span class=nv>%eax</span>
<a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a><span class=w> </span><span class=nf>movl</span><span class=w> </span><span class=nv>%r9d</span><span class=p>,</span><span class=w> </span><span class=nv>%r8d</span>
<a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a><span class=w> </span><span class=nf>andl</span><span class=w> </span><span class=no>$3</span><span class=p>,</span><span class=w> </span><span class=nv>%r8d</span>
<a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a><span class=w> </span><span class=nf>cmpl</span><span class=w> </span><span class=no>$3</span><span class=p>,</span><span class=w> </span><span class=nv>%eax</span>
<a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a><span class=w> </span><span class=nf>jb</span><span class=w> </span><span class=no>.LBB3_4</span>
<a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a><span class=c1># %bb.2:</span>
<a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a><span class=w> </span><span class=nf>andl</span><span class=w> </span><span class=no>$-4</span><span class=p>,</span><span class=w> </span><span class=nv>%r9d</span>
<a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a><span class=w> </span><span class=nf>negl</span><span class=w> </span><span class=nv>%r9d</span>
<a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a><span class=w> </span><span class=na>.p2align</span><span class=w> </span><span class=mi>4</span><span class=p>,</span><span class=w> </span><span class=mi>0x90</span>
<a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a><span class=nl>.LBB3_3:</span><span class=w>                                </span><span class=c1># =&gt;This Inner Loop Header: Depth=1</span>
<a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a><span class=w> </span><span class=nf>vmovups</span><span class=w> </span><span class=p>(</span><span class=nv>%rdi</span><span class=p>),</span><span class=w> </span><span class=nv>%zmm0</span>
<a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a><span class=w> </span><span class=nf>vmulps</span><span class=w> </span><span class=p>(</span><span class=nv>%rsi</span><span class=p>),</span><span class=w> </span><span class=nv>%zmm0</span><span class=p>,</span><span class=w> </span><span class=nv>%zmm0</span>
<a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a><span class=w> </span><span class=nf>vmovups</span><span class=w> </span><span class=nv>%zmm0</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nv>%rdx</span><span class=p>)</span>
<a id=__codelineno-2-32 name=__codelineno-2-32 href=#__codelineno-2-32></a><span class=w> </span><span class=nf>vmovups</span><span class=w> </span><span class=mi>64</span><span class=p>(</span><span class=nv>%rdi</span><span class=p>),</span><span class=w> </span><span class=nv>%zmm0</span>
<a id=__codelineno-2-33 name=__codelineno-2-33 href=#__codelineno-2-33></a><span class=w> </span><span class=nf>vmulps</span><span class=w> </span><span class=mi>64</span><span class=p>(</span><span class=nv>%rsi</span><span class=p>),</span><span class=w> </span><span class=nv>%zmm0</span><span class=p>,</span><span class=w> </span><span class=nv>%zmm0</span>
<a id=__codelineno-2-34 name=__codelineno-2-34 href=#__codelineno-2-34></a><span class=w> </span><span class=nf>vmovups</span><span class=w> </span><span class=nv>%zmm0</span><span class=p>,</span><span class=w> </span><span class=mi>64</span><span class=p>(</span><span class=nv>%rdx</span><span class=p>)</span>
<a id=__codelineno-2-35 name=__codelineno-2-35 href=#__codelineno-2-35></a><span class=w> </span><span class=nf>vmovups</span><span class=w> </span><span class=mi>128</span><span class=p>(</span><span class=nv>%rdi</span><span class=p>),</span><span class=w> </span><span class=nv>%zmm0</span>
<a id=__codelineno-2-36 name=__codelineno-2-36 href=#__codelineno-2-36></a><span class=w> </span><span class=nf>vmulps</span><span class=w> </span><span class=mi>128</span><span class=p>(</span><span class=nv>%rsi</span><span class=p>),</span><span class=w> </span><span class=nv>%zmm0</span><span class=p>,</span><span class=w> </span><span class=nv>%zmm0</span>
<a id=__codelineno-2-37 name=__codelineno-2-37 href=#__codelineno-2-37></a><span class=w> </span><span class=nf>vmovups</span><span class=w> </span><span class=nv>%zmm0</span><span class=p>,</span><span class=w> </span><span class=mi>128</span><span class=p>(</span><span class=nv>%rdx</span><span class=p>)</span>
<a id=__codelineno-2-38 name=__codelineno-2-38 href=#__codelineno-2-38></a><span class=w> </span><span class=nf>vmovups</span><span class=w> </span><span class=mi>192</span><span class=p>(</span><span class=nv>%rdi</span><span class=p>),</span><span class=w> </span><span class=nv>%zmm0</span>
<a id=__codelineno-2-39 name=__codelineno-2-39 href=#__codelineno-2-39></a><span class=w> </span><span class=nf>vmulps</span><span class=w> </span><span class=mi>192</span><span class=p>(</span><span class=nv>%rsi</span><span class=p>),</span><span class=w> </span><span class=nv>%zmm0</span><span class=p>,</span><span class=w> </span><span class=nv>%zmm0</span>
<a id=__codelineno-2-40 name=__codelineno-2-40 href=#__codelineno-2-40></a><span class=w> </span><span class=nf>vmovups</span><span class=w> </span><span class=nv>%zmm0</span><span class=p>,</span><span class=w> </span><span class=mi>192</span><span class=p>(</span><span class=nv>%rdx</span><span class=p>)</span>
<a id=__codelineno-2-41 name=__codelineno-2-41 href=#__codelineno-2-41></a><span class=w> </span><span class=nf>addq</span><span class=w> </span><span class=no>$256</span><span class=p>,</span><span class=w> </span><span class=nv>%rdi</span><span class=w>                      </span><span class=c1># imm = 0x100</span>
<a id=__codelineno-2-42 name=__codelineno-2-42 href=#__codelineno-2-42></a><span class=w> </span><span class=nf>addq</span><span class=w> </span><span class=no>$256</span><span class=p>,</span><span class=w> </span><span class=nv>%rsi</span><span class=w>                      </span><span class=c1># imm = 0x100</span>
<a id=__codelineno-2-43 name=__codelineno-2-43 href=#__codelineno-2-43></a><span class=w> </span><span class=nf>addq</span><span class=w> </span><span class=no>$256</span><span class=p>,</span><span class=w> </span><span class=nv>%rdx</span><span class=w>                      </span><span class=c1># imm = 0x100</span>
<a id=__codelineno-2-44 name=__codelineno-2-44 href=#__codelineno-2-44></a><span class=w> </span><span class=nf>addl</span><span class=w> </span><span class=no>$4</span><span class=p>,</span><span class=w> </span><span class=nv>%r9d</span>
<a id=__codelineno-2-45 name=__codelineno-2-45 href=#__codelineno-2-45></a><span class=w> </span><span class=nf>jne</span><span class=w> </span><span class=no>.LBB3_3</span>
<a id=__codelineno-2-46 name=__codelineno-2-46 href=#__codelineno-2-46></a><span class=nl>.LBB3_4:</span>
<a id=__codelineno-2-47 name=__codelineno-2-47 href=#__codelineno-2-47></a><span class=w> </span><span class=nf>testl</span><span class=w> </span><span class=nv>%r8d</span><span class=p>,</span><span class=w> </span><span class=nv>%r8d</span>
<a id=__codelineno-2-48 name=__codelineno-2-48 href=#__codelineno-2-48></a><span class=w> </span><span class=nf>je</span><span class=w> </span><span class=no>.LBB3_6</span>
<a id=__codelineno-2-49 name=__codelineno-2-49 href=#__codelineno-2-49></a><span class=w> </span><span class=na>.p2align</span><span class=w> </span><span class=mi>4</span><span class=p>,</span><span class=w> </span><span class=mi>0x90</span>
<a id=__codelineno-2-50 name=__codelineno-2-50 href=#__codelineno-2-50></a><span class=nl>.LBB3_5:</span><span class=w>                                </span><span class=c1># =&gt;This Inner Loop Header: Depth=1</span>
<a id=__codelineno-2-51 name=__codelineno-2-51 href=#__codelineno-2-51></a><span class=w> </span><span class=nf>vmovups</span><span class=w> </span><span class=p>(</span><span class=nv>%rdi</span><span class=p>),</span><span class=w> </span><span class=nv>%zmm0</span>
<a id=__codelineno-2-52 name=__codelineno-2-52 href=#__codelineno-2-52></a><span class=w> </span><span class=nf>vmulps</span><span class=w> </span><span class=p>(</span><span class=nv>%rsi</span><span class=p>),</span><span class=w> </span><span class=nv>%zmm0</span><span class=p>,</span><span class=w> </span><span class=nv>%zmm0</span>
<a id=__codelineno-2-53 name=__codelineno-2-53 href=#__codelineno-2-53></a><span class=w> </span><span class=nf>vmovups</span><span class=w> </span><span class=nv>%zmm0</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nv>%rdx</span><span class=p>)</span>
<a id=__codelineno-2-54 name=__codelineno-2-54 href=#__codelineno-2-54></a><span class=w> </span><span class=nf>addq</span><span class=w> </span><span class=no>$64</span><span class=p>,</span><span class=w> </span><span class=nv>%rdi</span>
<a id=__codelineno-2-55 name=__codelineno-2-55 href=#__codelineno-2-55></a><span class=w> </span><span class=nf>addq</span><span class=w> </span><span class=no>$64</span><span class=p>,</span><span class=w> </span><span class=nv>%rsi</span>
<a id=__codelineno-2-56 name=__codelineno-2-56 href=#__codelineno-2-56></a><span class=w> </span><span class=nf>addq</span><span class=w> </span><span class=no>$64</span><span class=p>,</span><span class=w> </span><span class=nv>%rdx</span>
<a id=__codelineno-2-57 name=__codelineno-2-57 href=#__codelineno-2-57></a><span class=w> </span><span class=nf>addl</span><span class=w> </span><span class=no>$-1</span><span class=p>,</span><span class=w> </span><span class=nv>%r8d</span>
<a id=__codelineno-2-58 name=__codelineno-2-58 href=#__codelineno-2-58></a><span class=w> </span><span class=nf>jne</span><span class=w> </span><span class=no>.LBB3_5</span>
<a id=__codelineno-2-59 name=__codelineno-2-59 href=#__codelineno-2-59></a><span class=nl>.LBB3_6:</span>
<a id=__codelineno-2-60 name=__codelineno-2-60 href=#__codelineno-2-60></a><span class=w> </span><span class=nf>cmpl</span><span class=w> </span><span class=no>$7</span><span class=p>,</span><span class=w> </span><span class=nv>%ecx</span>
<a id=__codelineno-2-61 name=__codelineno-2-61 href=#__codelineno-2-61></a><span class=w> </span><span class=nf>jle</span><span class=w> </span><span class=no>.LBB3_8</span>
<a id=__codelineno-2-62 name=__codelineno-2-62 href=#__codelineno-2-62></a><span class=c1># %bb.7:</span>
<a id=__codelineno-2-63 name=__codelineno-2-63 href=#__codelineno-2-63></a><span class=w> </span><span class=nf>vmovups</span><span class=w> </span><span class=p>(</span><span class=nv>%rdi</span><span class=p>),</span><span class=w> </span><span class=nv>%ymm0</span>
<a id=__codelineno-2-64 name=__codelineno-2-64 href=#__codelineno-2-64></a><span class=w> </span><span class=nf>vmulps</span><span class=w> </span><span class=p>(</span><span class=nv>%rsi</span><span class=p>),</span><span class=w> </span><span class=nv>%ymm0</span><span class=p>,</span><span class=w> </span><span class=nv>%ymm0</span>
<a id=__codelineno-2-65 name=__codelineno-2-65 href=#__codelineno-2-65></a><span class=w> </span><span class=nf>vmovups</span><span class=w> </span><span class=nv>%ymm0</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nv>%rdx</span><span class=p>)</span>
<a id=__codelineno-2-66 name=__codelineno-2-66 href=#__codelineno-2-66></a><span class=w> </span><span class=nf>addq</span><span class=w> </span><span class=no>$32</span><span class=p>,</span><span class=w> </span><span class=nv>%rdi</span>
<a id=__codelineno-2-67 name=__codelineno-2-67 href=#__codelineno-2-67></a><span class=w> </span><span class=nf>addq</span><span class=w> </span><span class=no>$32</span><span class=p>,</span><span class=w> </span><span class=nv>%rsi</span>
<a id=__codelineno-2-68 name=__codelineno-2-68 href=#__codelineno-2-68></a><span class=w> </span><span class=nf>addq</span><span class=w> </span><span class=no>$32</span><span class=p>,</span><span class=w> </span><span class=nv>%rdx</span>
<a id=__codelineno-2-69 name=__codelineno-2-69 href=#__codelineno-2-69></a><span class=w> </span><span class=nf>addl</span><span class=w> </span><span class=no>$-8</span><span class=p>,</span><span class=w> </span><span class=nv>%ecx</span>
<a id=__codelineno-2-70 name=__codelineno-2-70 href=#__codelineno-2-70></a><span class=nl>.LBB3_8:</span>
<a id=__codelineno-2-71 name=__codelineno-2-71 href=#__codelineno-2-71></a><span class=w> </span><span class=nf>testl</span><span class=w> </span><span class=nv>%ecx</span><span class=p>,</span><span class=w> </span><span class=nv>%ecx</span>
<a id=__codelineno-2-72 name=__codelineno-2-72 href=#__codelineno-2-72></a><span class=w> </span><span class=nf>jle</span><span class=w> </span><span class=no>.LBB3_14</span>
<a id=__codelineno-2-73 name=__codelineno-2-73 href=#__codelineno-2-73></a><span class=c1># %bb.9:</span>
<a id=__codelineno-2-74 name=__codelineno-2-74 href=#__codelineno-2-74></a><span class=w> </span><span class=nf>movl</span><span class=w> </span><span class=nv>%ecx</span><span class=p>,</span><span class=w> </span><span class=nv>%ecx</span>
<a id=__codelineno-2-75 name=__codelineno-2-75 href=#__codelineno-2-75></a><span class=w> </span><span class=nf>leaq</span><span class=w> </span><span class=mi>-1</span><span class=p>(</span><span class=nv>%rcx</span><span class=p>),</span><span class=w> </span><span class=nv>%rax</span>
<a id=__codelineno-2-76 name=__codelineno-2-76 href=#__codelineno-2-76></a><span class=w> </span><span class=nf>movl</span><span class=w> </span><span class=nv>%ecx</span><span class=p>,</span><span class=w> </span><span class=nv>%r8d</span>
<a id=__codelineno-2-77 name=__codelineno-2-77 href=#__codelineno-2-77></a><span class=w> </span><span class=nf>andl</span><span class=w> </span><span class=no>$3</span><span class=p>,</span><span class=w> </span><span class=nv>%r8d</span>
<a id=__codelineno-2-78 name=__codelineno-2-78 href=#__codelineno-2-78></a><span class=w> </span><span class=nf>cmpq</span><span class=w> </span><span class=no>$3</span><span class=p>,</span><span class=w> </span><span class=nv>%rax</span>
<a id=__codelineno-2-79 name=__codelineno-2-79 href=#__codelineno-2-79></a><span class=w> </span><span class=nf>jae</span><span class=w> </span><span class=no>.LBB3_15</span>
<a id=__codelineno-2-80 name=__codelineno-2-80 href=#__codelineno-2-80></a><span class=c1># %bb.10:</span>
<a id=__codelineno-2-81 name=__codelineno-2-81 href=#__codelineno-2-81></a><span class=w> </span><span class=nf>xorl</span><span class=w> </span><span class=nv>%eax</span><span class=p>,</span><span class=w> </span><span class=nv>%eax</span>
<a id=__codelineno-2-82 name=__codelineno-2-82 href=#__codelineno-2-82></a><span class=w> </span><span class=nf>jmp</span><span class=w> </span><span class=no>.LBB3_11</span>
<a id=__codelineno-2-83 name=__codelineno-2-83 href=#__codelineno-2-83></a><span class=nl>.LBB3_15:</span>
<a id=__codelineno-2-84 name=__codelineno-2-84 href=#__codelineno-2-84></a><span class=w> </span><span class=nf>andl</span><span class=w> </span><span class=no>$-4</span><span class=p>,</span><span class=w> </span><span class=nv>%ecx</span>
<a id=__codelineno-2-85 name=__codelineno-2-85 href=#__codelineno-2-85></a><span class=w> </span><span class=nf>xorl</span><span class=w> </span><span class=nv>%eax</span><span class=p>,</span><span class=w> </span><span class=nv>%eax</span>
<a id=__codelineno-2-86 name=__codelineno-2-86 href=#__codelineno-2-86></a><span class=w> </span><span class=na>.p2align</span><span class=w> </span><span class=mi>4</span><span class=p>,</span><span class=w> </span><span class=mi>0x90</span>
<a id=__codelineno-2-87 name=__codelineno-2-87 href=#__codelineno-2-87></a><span class=nl>.LBB3_16:</span><span class=w>                               </span><span class=c1># =&gt;This Inner Loop Header: Depth=1</span>
<a id=__codelineno-2-88 name=__codelineno-2-88 href=#__codelineno-2-88></a><span class=w> </span><span class=nf>vmovss</span><span class=w> </span><span class=p>(</span><span class=nv>%rdi</span><span class=p>,</span><span class=nv>%rax</span><span class=p>,</span><span class=mi>4</span><span class=p>),</span><span class=w> </span><span class=nv>%xmm0</span><span class=w>            </span><span class=c1># xmm0 = mem[0],zero,zero,zero</span>
<a id=__codelineno-2-89 name=__codelineno-2-89 href=#__codelineno-2-89></a><span class=w> </span><span class=nf>vmulss</span><span class=w> </span><span class=p>(</span><span class=nv>%rsi</span><span class=p>,</span><span class=nv>%rax</span><span class=p>,</span><span class=mi>4</span><span class=p>),</span><span class=w> </span><span class=nv>%xmm0</span><span class=p>,</span><span class=w> </span><span class=nv>%xmm0</span>
<a id=__codelineno-2-90 name=__codelineno-2-90 href=#__codelineno-2-90></a><span class=w> </span><span class=nf>vmovss</span><span class=w> </span><span class=nv>%xmm0</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nv>%rdx</span><span class=p>,</span><span class=nv>%rax</span><span class=p>,</span><span class=mi>4</span><span class=p>)</span>
<a id=__codelineno-2-91 name=__codelineno-2-91 href=#__codelineno-2-91></a><span class=w> </span><span class=nf>vmovss</span><span class=w> </span><span class=mi>4</span><span class=p>(</span><span class=nv>%rdi</span><span class=p>,</span><span class=nv>%rax</span><span class=p>,</span><span class=mi>4</span><span class=p>),</span><span class=w> </span><span class=nv>%xmm0</span><span class=w>           </span><span class=c1># xmm0 = mem[0],zero,zero,zero</span>
<a id=__codelineno-2-92 name=__codelineno-2-92 href=#__codelineno-2-92></a><span class=w> </span><span class=nf>vmulss</span><span class=w> </span><span class=mi>4</span><span class=p>(</span><span class=nv>%rsi</span><span class=p>,</span><span class=nv>%rax</span><span class=p>,</span><span class=mi>4</span><span class=p>),</span><span class=w> </span><span class=nv>%xmm0</span><span class=p>,</span><span class=w> </span><span class=nv>%xmm0</span>
<a id=__codelineno-2-93 name=__codelineno-2-93 href=#__codelineno-2-93></a><span class=w> </span><span class=nf>vmovss</span><span class=w> </span><span class=nv>%xmm0</span><span class=p>,</span><span class=w> </span><span class=mi>4</span><span class=p>(</span><span class=nv>%rdx</span><span class=p>,</span><span class=nv>%rax</span><span class=p>,</span><span class=mi>4</span><span class=p>)</span>
<a id=__codelineno-2-94 name=__codelineno-2-94 href=#__codelineno-2-94></a><span class=w> </span><span class=nf>vmovss</span><span class=w> </span><span class=mi>8</span><span class=p>(</span><span class=nv>%rdi</span><span class=p>,</span><span class=nv>%rax</span><span class=p>,</span><span class=mi>4</span><span class=p>),</span><span class=w> </span><span class=nv>%xmm0</span><span class=w>           </span><span class=c1># xmm0 = mem[0],zero,zero,zero</span>
<a id=__codelineno-2-95 name=__codelineno-2-95 href=#__codelineno-2-95></a><span class=w> </span><span class=nf>vmulss</span><span class=w> </span><span class=mi>8</span><span class=p>(</span><span class=nv>%rsi</span><span class=p>,</span><span class=nv>%rax</span><span class=p>,</span><span class=mi>4</span><span class=p>),</span><span class=w> </span><span class=nv>%xmm0</span><span class=p>,</span><span class=w> </span><span class=nv>%xmm0</span>
<a id=__codelineno-2-96 name=__codelineno-2-96 href=#__codelineno-2-96></a><span class=w> </span><span class=nf>vmovss</span><span class=w> </span><span class=nv>%xmm0</span><span class=p>,</span><span class=w> </span><span class=mi>8</span><span class=p>(</span><span class=nv>%rdx</span><span class=p>,</span><span class=nv>%rax</span><span class=p>,</span><span class=mi>4</span><span class=p>)</span>
<a id=__codelineno-2-97 name=__codelineno-2-97 href=#__codelineno-2-97></a><span class=w> </span><span class=nf>vmovss</span><span class=w> </span><span class=mi>12</span><span class=p>(</span><span class=nv>%rdi</span><span class=p>,</span><span class=nv>%rax</span><span class=p>,</span><span class=mi>4</span><span class=p>),</span><span class=w> </span><span class=nv>%xmm0</span><span class=w>          </span><span class=c1># xmm0 = mem[0],zero,zero,zero</span>
<a id=__codelineno-2-98 name=__codelineno-2-98 href=#__codelineno-2-98></a><span class=w> </span><span class=nf>vmulss</span><span class=w> </span><span class=mi>12</span><span class=p>(</span><span class=nv>%rsi</span><span class=p>,</span><span class=nv>%rax</span><span class=p>,</span><span class=mi>4</span><span class=p>),</span><span class=w> </span><span class=nv>%xmm0</span><span class=p>,</span><span class=w> </span><span class=nv>%xmm0</span>
<a id=__codelineno-2-99 name=__codelineno-2-99 href=#__codelineno-2-99></a><span class=w> </span><span class=nf>vmovss</span><span class=w> </span><span class=nv>%xmm0</span><span class=p>,</span><span class=w> </span><span class=mi>12</span><span class=p>(</span><span class=nv>%rdx</span><span class=p>,</span><span class=nv>%rax</span><span class=p>,</span><span class=mi>4</span><span class=p>)</span>
<a id=__codelineno-2-100 name=__codelineno-2-100 href=#__codelineno-2-100></a><span class=w> </span><span class=nf>addq</span><span class=w> </span><span class=no>$4</span><span class=p>,</span><span class=w> </span><span class=nv>%rax</span>
<a id=__codelineno-2-101 name=__codelineno-2-101 href=#__codelineno-2-101></a><span class=w> </span><span class=nf>cmpq</span><span class=w> </span><span class=nv>%rax</span><span class=p>,</span><span class=w> </span><span class=nv>%rcx</span>
<a id=__codelineno-2-102 name=__codelineno-2-102 href=#__codelineno-2-102></a><span class=w> </span><span class=nf>jne</span><span class=w> </span><span class=no>.LBB3_16</span>
<a id=__codelineno-2-103 name=__codelineno-2-103 href=#__codelineno-2-103></a><span class=nl>.LBB3_11:</span>
<a id=__codelineno-2-104 name=__codelineno-2-104 href=#__codelineno-2-104></a><span class=w> </span><span class=nf>testq</span><span class=w> </span><span class=nv>%r8</span><span class=p>,</span><span class=w> </span><span class=nv>%r8</span>
<a id=__codelineno-2-105 name=__codelineno-2-105 href=#__codelineno-2-105></a><span class=w> </span><span class=nf>je</span><span class=w> </span><span class=no>.LBB3_14</span>
<a id=__codelineno-2-106 name=__codelineno-2-106 href=#__codelineno-2-106></a><span class=c1># %bb.12:</span>
<a id=__codelineno-2-107 name=__codelineno-2-107 href=#__codelineno-2-107></a><span class=w> </span><span class=nf>leaq</span><span class=w> </span><span class=p>(</span><span class=nv>%rdx</span><span class=p>,</span><span class=nv>%rax</span><span class=p>,</span><span class=mi>4</span><span class=p>),</span><span class=w> </span><span class=nv>%rcx</span>
<a id=__codelineno-2-108 name=__codelineno-2-108 href=#__codelineno-2-108></a><span class=w> </span><span class=nf>leaq</span><span class=w> </span><span class=p>(</span><span class=nv>%rsi</span><span class=p>,</span><span class=nv>%rax</span><span class=p>,</span><span class=mi>4</span><span class=p>),</span><span class=w> </span><span class=nv>%rdx</span>
<a id=__codelineno-2-109 name=__codelineno-2-109 href=#__codelineno-2-109></a><span class=w> </span><span class=nf>leaq</span><span class=w> </span><span class=p>(</span><span class=nv>%rdi</span><span class=p>,</span><span class=nv>%rax</span><span class=p>,</span><span class=mi>4</span><span class=p>),</span><span class=w> </span><span class=nv>%rax</span>
<a id=__codelineno-2-110 name=__codelineno-2-110 href=#__codelineno-2-110></a><span class=w> </span><span class=nf>xorl</span><span class=w> </span><span class=nv>%esi</span><span class=p>,</span><span class=w> </span><span class=nv>%esi</span>
<a id=__codelineno-2-111 name=__codelineno-2-111 href=#__codelineno-2-111></a><span class=w> </span><span class=na>.p2align</span><span class=w> </span><span class=mi>4</span><span class=p>,</span><span class=w> </span><span class=mi>0x90</span>
<a id=__codelineno-2-112 name=__codelineno-2-112 href=#__codelineno-2-112></a><span class=nl>.LBB3_13:</span><span class=w>                               </span><span class=c1># =&gt;This Inner Loop Header: Depth=1</span>
<a id=__codelineno-2-113 name=__codelineno-2-113 href=#__codelineno-2-113></a><span class=w> </span><span class=nf>vmovss</span><span class=w> </span><span class=p>(</span><span class=nv>%rax</span><span class=p>,</span><span class=nv>%rsi</span><span class=p>,</span><span class=mi>4</span><span class=p>),</span><span class=w> </span><span class=nv>%xmm0</span><span class=w>            </span><span class=c1># xmm0 = mem[0],zero,zero,zero</span>
<a id=__codelineno-2-114 name=__codelineno-2-114 href=#__codelineno-2-114></a><span class=w> </span><span class=nf>vmulss</span><span class=w> </span><span class=p>(</span><span class=nv>%rdx</span><span class=p>,</span><span class=nv>%rsi</span><span class=p>,</span><span class=mi>4</span><span class=p>),</span><span class=w> </span><span class=nv>%xmm0</span><span class=p>,</span><span class=w> </span><span class=nv>%xmm0</span>
<a id=__codelineno-2-115 name=__codelineno-2-115 href=#__codelineno-2-115></a><span class=w> </span><span class=nf>vmovss</span><span class=w> </span><span class=nv>%xmm0</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nv>%rcx</span><span class=p>,</span><span class=nv>%rsi</span><span class=p>,</span><span class=mi>4</span><span class=p>)</span>
<a id=__codelineno-2-116 name=__codelineno-2-116 href=#__codelineno-2-116></a><span class=w> </span><span class=nf>addq</span><span class=w> </span><span class=no>$1</span><span class=p>,</span><span class=w> </span><span class=nv>%rsi</span>
<a id=__codelineno-2-117 name=__codelineno-2-117 href=#__codelineno-2-117></a><span class=w> </span><span class=nf>cmpq</span><span class=w> </span><span class=nv>%rsi</span><span class=p>,</span><span class=w> </span><span class=nv>%r8</span>
<a id=__codelineno-2-118 name=__codelineno-2-118 href=#__codelineno-2-118></a><span class=w> </span><span class=nf>jne</span><span class=w> </span><span class=no>.LBB3_13</span>
<a id=__codelineno-2-119 name=__codelineno-2-119 href=#__codelineno-2-119></a><span class=nl>.LBB3_14:</span>
<a id=__codelineno-2-120 name=__codelineno-2-120 href=#__codelineno-2-120></a><span class=w> </span><span class=nf>movq</span><span class=w> </span><span class=nv>%rbp</span><span class=p>,</span><span class=w> </span><span class=nv>%rsp</span>
<a id=__codelineno-2-121 name=__codelineno-2-121 href=#__codelineno-2-121></a><span class=w> </span><span class=nf>popq</span><span class=w> </span><span class=nv>%rbp</span>
<a id=__codelineno-2-122 name=__codelineno-2-122 href=#__codelineno-2-122></a><span class=w> </span><span class=nf>vzeroupper</span>
<a id=__codelineno-2-123 name=__codelineno-2-123 href=#__codelineno-2-123></a><span class=w> </span><span class=nf>retq</span>
<a id=__codelineno-2-124 name=__codelineno-2-124 href=#__codelineno-2-124></a><span class=nl>.Lfunc_end3:</span>
<a id=__codelineno-2-125 name=__codelineno-2-125 href=#__codelineno-2-125></a><span class=w> </span><span class=na>.size</span><span class=w> </span><span class=no>_mm512_mul_to</span><span class=p>,</span><span class=w> </span><span class=no>.Lfunc_end3-_mm512_mul_to</span>
<a id=__codelineno-2-126 name=__codelineno-2-126 href=#__codelineno-2-126></a><span class=w>                                        </span><span class=c1># -- End function</span>
</code></pre></div> <p>:::</p> <p>In Go, it is easy to execute the compile command with <code>exec.Command</code>.</p> <h2 id=construct-go-code-from-assembly>Construct Go Code from Assembly<a class=headerlink href=#construct-go-code-from-assembly title="Permanent link">&para;</a></h2> <h3 id=convert-assembly>Convert Assembly<a class=headerlink href=#convert-assembly title="Permanent link">&para;</a></h3> <p><code>mm512_mul_to.o</code> is the binary of the function after it has been compiled. By using <code>objdump</code> you can see that each assembly has been converted to machine code.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>objdump<span class=w> </span>-d<span class=w> </span>mm512_mul_to.o<span class=w> </span>--insn-width<span class=w> </span><span class=m>16</span>
</code></pre></div> <p>::: details objdump output</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>0000000000000460 &lt;_mm512_mul_to&gt;:
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a> 460:   55                              push   %rbp
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a> 461:   48 89 e5                        mov    %rsp,%rbp
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a> 464:   48 83 e4 f8                     and    $0xfffffffffffffff8,%rsp
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a> 468:   4c 8d 49 0f                     lea    0xf(%rcx),%r9
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a> 46c:   48 85 c9                        test   %rcx,%rcx
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a> 46f:   4c 0f 49 c9                     cmovns %rcx,%r9
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a> 473:   49 c1 e9 04                     shr    $0x4,%r9
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a> 477:   44 89 c8                        mov    %r9d,%eax
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a> 47a:   c1 e0 04                        shl    $0x4,%eax
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a> 47d:   29 c1                           sub    %eax,%ecx
<a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a> 47f:   45 85 c9                        test   %r9d,%r9d
<a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a> 482:   0f 8e bc 00 00 00               jle    544 &lt;_mm512_mul_to+0xe4&gt;
<a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a> 488:   41 8d 41 ff                     lea    -0x1(%r9),%eax
<a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a> 48c:   45 89 c8                        mov    %r9d,%r8d
<a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a> 48f:   41 83 e0 03                     and    $0x3,%r8d
<a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a> 493:   83 f8 03                        cmp    $0x3,%eax
<a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a> 496:   72 74                           jb     50c &lt;_mm512_mul_to+0xac&gt;
<a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a> 498:   41 83 e1 fc                     and    $0xfffffffc,%r9d
<a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a> 49c:   41 f7 d9                        neg    %r9d
<a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a> 49f:   90                              nop
<a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a> 4a0:   62 f1 7c 48 10 07               vmovups (%rdi),%zmm0
<a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a> 4a6:   62 f1 7c 48 59 06               vmulps (%rsi),%zmm0,%zmm0
<a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a> 4ac:   62 f1 7c 48 11 02               vmovups %zmm0,(%rdx)
<a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a> 4b2:   62 f1 7c 48 10 47 01            vmovups 0x40(%rdi),%zmm0
<a id=__codelineno-4-26 name=__codelineno-4-26 href=#__codelineno-4-26></a> 4b9:   62 f1 7c 48 59 46 01            vmulps 0x40(%rsi),%zmm0,%zmm0
<a id=__codelineno-4-27 name=__codelineno-4-27 href=#__codelineno-4-27></a> 4c0:   62 f1 7c 48 11 42 01            vmovups %zmm0,0x40(%rdx)
<a id=__codelineno-4-28 name=__codelineno-4-28 href=#__codelineno-4-28></a> 4c7:   62 f1 7c 48 10 47 02            vmovups 0x80(%rdi),%zmm0
<a id=__codelineno-4-29 name=__codelineno-4-29 href=#__codelineno-4-29></a> 4ce:   62 f1 7c 48 59 46 02            vmulps 0x80(%rsi),%zmm0,%zmm0
<a id=__codelineno-4-30 name=__codelineno-4-30 href=#__codelineno-4-30></a> 4d5:   62 f1 7c 48 11 42 02            vmovups %zmm0,0x80(%rdx)
<a id=__codelineno-4-31 name=__codelineno-4-31 href=#__codelineno-4-31></a> 4dc:   62 f1 7c 48 10 47 03            vmovups 0xc0(%rdi),%zmm0
<a id=__codelineno-4-32 name=__codelineno-4-32 href=#__codelineno-4-32></a> 4e3:   62 f1 7c 48 59 46 03            vmulps 0xc0(%rsi),%zmm0,%zmm0
<a id=__codelineno-4-33 name=__codelineno-4-33 href=#__codelineno-4-33></a> 4ea:   62 f1 7c 48 11 42 03            vmovups %zmm0,0xc0(%rdx)
<a id=__codelineno-4-34 name=__codelineno-4-34 href=#__codelineno-4-34></a> 4f1:   48 81 c7 00 01 00 00            add    $0x100,%rdi
<a id=__codelineno-4-35 name=__codelineno-4-35 href=#__codelineno-4-35></a> 4f8:   48 81 c6 00 01 00 00            add    $0x100,%rsi
<a id=__codelineno-4-36 name=__codelineno-4-36 href=#__codelineno-4-36></a> 4ff:   48 81 c2 00 01 00 00            add    $0x100,%rdx
<a id=__codelineno-4-37 name=__codelineno-4-37 href=#__codelineno-4-37></a> 506:   41 83 c1 04                     add    $0x4,%r9d
<a id=__codelineno-4-38 name=__codelineno-4-38 href=#__codelineno-4-38></a> 50a:   75 94                           jne    4a0 &lt;_mm512_mul_to+0x40&gt;
<a id=__codelineno-4-39 name=__codelineno-4-39 href=#__codelineno-4-39></a> 50c:   45 85 c0                        test   %r8d,%r8d
<a id=__codelineno-4-40 name=__codelineno-4-40 href=#__codelineno-4-40></a> 50f:   74 33                           je     544 &lt;_mm512_mul_to+0xe4&gt;
<a id=__codelineno-4-41 name=__codelineno-4-41 href=#__codelineno-4-41></a> 511:   66 2e 0f 1f 84 00 00 00 00 00   nopw   %cs:0x0(%rax,%rax,1)
<a id=__codelineno-4-42 name=__codelineno-4-42 href=#__codelineno-4-42></a> 51b:   0f 1f 44 00 00                  nopl   0x0(%rax,%rax,1)
<a id=__codelineno-4-43 name=__codelineno-4-43 href=#__codelineno-4-43></a> 520:   62 f1 7c 48 10 07               vmovups (%rdi),%zmm0
<a id=__codelineno-4-44 name=__codelineno-4-44 href=#__codelineno-4-44></a> 526:   62 f1 7c 48 59 06               vmulps (%rsi),%zmm0,%zmm0
<a id=__codelineno-4-45 name=__codelineno-4-45 href=#__codelineno-4-45></a> 52c:   62 f1 7c 48 11 02               vmovups %zmm0,(%rdx)
<a id=__codelineno-4-46 name=__codelineno-4-46 href=#__codelineno-4-46></a> 532:   48 83 c7 40                     add    $0x40,%rdi
<a id=__codelineno-4-47 name=__codelineno-4-47 href=#__codelineno-4-47></a> 536:   48 83 c6 40                     add    $0x40,%rsi
<a id=__codelineno-4-48 name=__codelineno-4-48 href=#__codelineno-4-48></a> 53a:   48 83 c2 40                     add    $0x40,%rdx
<a id=__codelineno-4-49 name=__codelineno-4-49 href=#__codelineno-4-49></a> 53e:   41 83 c0 ff                     add    $0xffffffff,%r8d
<a id=__codelineno-4-50 name=__codelineno-4-50 href=#__codelineno-4-50></a> 542:   75 dc                           jne    520 &lt;_mm512_mul_to+0xc0&gt;
<a id=__codelineno-4-51 name=__codelineno-4-51 href=#__codelineno-4-51></a> 544:   83 f9 07                        cmp    $0x7,%ecx
<a id=__codelineno-4-52 name=__codelineno-4-52 href=#__codelineno-4-52></a> 547:   7e 1b                           jle    564 &lt;_mm512_mul_to+0x104&gt;
<a id=__codelineno-4-53 name=__codelineno-4-53 href=#__codelineno-4-53></a> 549:   c5 fc 10 07                     vmovups (%rdi),%ymm0
<a id=__codelineno-4-54 name=__codelineno-4-54 href=#__codelineno-4-54></a> 54d:   c5 fc 59 06                     vmulps (%rsi),%ymm0,%ymm0
<a id=__codelineno-4-55 name=__codelineno-4-55 href=#__codelineno-4-55></a> 551:   c5 fc 11 02                     vmovups %ymm0,(%rdx)
<a id=__codelineno-4-56 name=__codelineno-4-56 href=#__codelineno-4-56></a> 555:   48 83 c7 20                     add    $0x20,%rdi
<a id=__codelineno-4-57 name=__codelineno-4-57 href=#__codelineno-4-57></a> 559:   48 83 c6 20                     add    $0x20,%rsi
<a id=__codelineno-4-58 name=__codelineno-4-58 href=#__codelineno-4-58></a> 55d:   48 83 c2 20                     add    $0x20,%rdx
<a id=__codelineno-4-59 name=__codelineno-4-59 href=#__codelineno-4-59></a> 561:   83 c1 f8                        add    $0xfffffff8,%ecx
<a id=__codelineno-4-60 name=__codelineno-4-60 href=#__codelineno-4-60></a> 564:   85 c9                           test   %ecx,%ecx
<a id=__codelineno-4-61 name=__codelineno-4-61 href=#__codelineno-4-61></a> 566:   0f 8e ac 00 00 00               jle    618 &lt;_mm512_mul_to+0x1b8&gt;
<a id=__codelineno-4-62 name=__codelineno-4-62 href=#__codelineno-4-62></a> 56c:   89 c9                           mov    %ecx,%ecx
<a id=__codelineno-4-63 name=__codelineno-4-63 href=#__codelineno-4-63></a> 56e:   48 8d 41 ff                     lea    -0x1(%rcx),%rax
<a id=__codelineno-4-64 name=__codelineno-4-64 href=#__codelineno-4-64></a> 572:   41 89 c8                        mov    %ecx,%r8d
<a id=__codelineno-4-65 name=__codelineno-4-65 href=#__codelineno-4-65></a> 575:   41 83 e0 03                     and    $0x3,%r8d
<a id=__codelineno-4-66 name=__codelineno-4-66 href=#__codelineno-4-66></a> 579:   48 83 f8 03                     cmp    $0x3,%rax
<a id=__codelineno-4-67 name=__codelineno-4-67 href=#__codelineno-4-67></a> 57d:   73 04                           jae    583 &lt;_mm512_mul_to+0x123&gt;
<a id=__codelineno-4-68 name=__codelineno-4-68 href=#__codelineno-4-68></a> 57f:   31 c0                           xor    %eax,%eax
<a id=__codelineno-4-69 name=__codelineno-4-69 href=#__codelineno-4-69></a> 581:   eb 5b                           jmp    5de &lt;_mm512_mul_to+0x17e&gt;
<a id=__codelineno-4-70 name=__codelineno-4-70 href=#__codelineno-4-70></a> 583:   83 e1 fc                        and    $0xfffffffc,%ecx
<a id=__codelineno-4-71 name=__codelineno-4-71 href=#__codelineno-4-71></a> 586:   31 c0                           xor    %eax,%eax
<a id=__codelineno-4-72 name=__codelineno-4-72 href=#__codelineno-4-72></a> 588:   0f 1f 84 00 00 00 00 00         nopl   0x0(%rax,%rax,1)
<a id=__codelineno-4-73 name=__codelineno-4-73 href=#__codelineno-4-73></a> 590:   c5 fa 10 04 87                  vmovss (%rdi,%rax,4),%xmm0
<a id=__codelineno-4-74 name=__codelineno-4-74 href=#__codelineno-4-74></a> 595:   c5 fa 59 04 86                  vmulss (%rsi,%rax,4),%xmm0,%xmm0
<a id=__codelineno-4-75 name=__codelineno-4-75 href=#__codelineno-4-75></a> 59a:   c5 fa 11 04 82                  vmovss %xmm0,(%rdx,%rax,4)
<a id=__codelineno-4-76 name=__codelineno-4-76 href=#__codelineno-4-76></a> 59f:   c5 fa 10 44 87 04               vmovss 0x4(%rdi,%rax,4),%xmm0
<a id=__codelineno-4-77 name=__codelineno-4-77 href=#__codelineno-4-77></a> 5a5:   c5 fa 59 44 86 04               vmulss 0x4(%rsi,%rax,4),%xmm0,%xmm0
<a id=__codelineno-4-78 name=__codelineno-4-78 href=#__codelineno-4-78></a> 5ab:   c5 fa 11 44 82 04               vmovss %xmm0,0x4(%rdx,%rax,4)
<a id=__codelineno-4-79 name=__codelineno-4-79 href=#__codelineno-4-79></a> 5b1:   c5 fa 10 44 87 08               vmovss 0x8(%rdi,%rax,4),%xmm0
<a id=__codelineno-4-80 name=__codelineno-4-80 href=#__codelineno-4-80></a> 5b7:   c5 fa 59 44 86 08               vmulss 0x8(%rsi,%rax,4),%xmm0,%xmm0
<a id=__codelineno-4-81 name=__codelineno-4-81 href=#__codelineno-4-81></a> 5bd:   c5 fa 11 44 82 08               vmovss %xmm0,0x8(%rdx,%rax,4)
<a id=__codelineno-4-82 name=__codelineno-4-82 href=#__codelineno-4-82></a> 5c3:   c5 fa 10 44 87 0c               vmovss 0xc(%rdi,%rax,4),%xmm0
<a id=__codelineno-4-83 name=__codelineno-4-83 href=#__codelineno-4-83></a> 5c9:   c5 fa 59 44 86 0c               vmulss 0xc(%rsi,%rax,4),%xmm0,%xmm0
<a id=__codelineno-4-84 name=__codelineno-4-84 href=#__codelineno-4-84></a> 5cf:   c5 fa 11 44 82 0c               vmovss %xmm0,0xc(%rdx,%rax,4)
<a id=__codelineno-4-85 name=__codelineno-4-85 href=#__codelineno-4-85></a> 5d5:   48 83 c0 04                     add    $0x4,%rax
<a id=__codelineno-4-86 name=__codelineno-4-86 href=#__codelineno-4-86></a> 5d9:   48 39 c1                        cmp    %rax,%rcx
<a id=__codelineno-4-87 name=__codelineno-4-87 href=#__codelineno-4-87></a> 5dc:   75 b2                           jne    590 &lt;_mm512_mul_to+0x130&gt;
<a id=__codelineno-4-88 name=__codelineno-4-88 href=#__codelineno-4-88></a> 5de:   4d 85 c0                        test   %r8,%r8
<a id=__codelineno-4-89 name=__codelineno-4-89 href=#__codelineno-4-89></a> 5e1:   74 35                           je     618 &lt;_mm512_mul_to+0x1b8&gt;
<a id=__codelineno-4-90 name=__codelineno-4-90 href=#__codelineno-4-90></a> 5e3:   48 8d 0c 82                     lea    (%rdx,%rax,4),%rcx
<a id=__codelineno-4-91 name=__codelineno-4-91 href=#__codelineno-4-91></a> 5e7:   48 8d 14 86                     lea    (%rsi,%rax,4),%rdx
<a id=__codelineno-4-92 name=__codelineno-4-92 href=#__codelineno-4-92></a> 5eb:   48 8d 04 87                     lea    (%rdi,%rax,4),%rax
<a id=__codelineno-4-93 name=__codelineno-4-93 href=#__codelineno-4-93></a> 5ef:   31 f6                           xor    %esi,%esi
<a id=__codelineno-4-94 name=__codelineno-4-94 href=#__codelineno-4-94></a> 5f1:   66 2e 0f 1f 84 00 00 00 00 00   nopw   %cs:0x0(%rax,%rax,1)
<a id=__codelineno-4-95 name=__codelineno-4-95 href=#__codelineno-4-95></a> 5fb:   0f 1f 44 00 00                  nopl   0x0(%rax,%rax,1)
<a id=__codelineno-4-96 name=__codelineno-4-96 href=#__codelineno-4-96></a> 600:   c5 fa 10 04 b0                  vmovss (%rax,%rsi,4),%xmm0
<a id=__codelineno-4-97 name=__codelineno-4-97 href=#__codelineno-4-97></a> 605:   c5 fa 59 04 b2                  vmulss (%rdx,%rsi,4),%xmm0,%xmm0
<a id=__codelineno-4-98 name=__codelineno-4-98 href=#__codelineno-4-98></a> 60a:   c5 fa 11 04 b1                  vmovss %xmm0,(%rcx,%rsi,4)
<a id=__codelineno-4-99 name=__codelineno-4-99 href=#__codelineno-4-99></a> 60f:   48 83 c6 01                     add    $0x1,%rsi
<a id=__codelineno-4-100 name=__codelineno-4-100 href=#__codelineno-4-100></a> 613:   49 39 f0                        cmp    %rsi,%r8
<a id=__codelineno-4-101 name=__codelineno-4-101 href=#__codelineno-4-101></a> 616:   75 e8                           jne    600 &lt;_mm512_mul_to+0x1a0&gt;
<a id=__codelineno-4-102 name=__codelineno-4-102 href=#__codelineno-4-102></a> 618:   48 89 ec                        mov    %rbp,%rsp
<a id=__codelineno-4-103 name=__codelineno-4-103 href=#__codelineno-4-103></a> 61b:   5d                              pop    %rbp
<a id=__codelineno-4-104 name=__codelineno-4-104 href=#__codelineno-4-104></a> 61c:   c5 f8 77                        vzeroupper 
<a id=__codelineno-4-105 name=__codelineno-4-105 href=#__codelineno-4-105></a> 61f:   c3                              retq   
</code></pre></div> <p>:::</p> <h4 id=encoding-machine-code>Encoding Machine Code<a class=headerlink href=#encoding-machine-code title="Permanent link">&para;</a></h4> <p>Go assembly provides three instructions for representing binary machine code.</p> <ul> <li><code>BYTE</code> encodes one byte of binary data</li> <li><code>WORD</code> encodes two bytes of binary data</li> <li><code>LONG</code> encodes four bytes of binary data</li> </ul> <p>If the instruction machine code length is exactly a multiple of two, for example</p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=w> </span><span class=err>498:</span><span class=w> </span><span class=err>41</span><span class=w> </span><span class=err>83</span><span class=w> </span><span class=nf>e1</span><span class=w> </span><span class=no>fc</span><span class=w> </span><span class=no>and</span><span class=w> </span><span class=no>$0xfffffffc</span><span class=p>,</span><span class=nv>%r9d</span>
</code></pre></div> <p>can be converted to</p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0xfce18341</span>
</code></pre></div> <p>But if the length is not a multiple of two, for example</p> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=w> </span><span class=err>4</span><span class=nl>b2:</span><span class=w> </span><span class=err>62</span><span class=w> </span><span class=nf>f1</span><span class=w> </span><span class=mi>7</span><span class=no>c</span><span class=w> </span><span class=mi>48</span><span class=w> </span><span class=mi>10</span><span class=w> </span><span class=mi>47</span><span class=w> </span><span class=mi>01</span><span class=w> </span><span class=no>vmovups</span><span class=w> </span><span class=mi>0x40</span><span class=p>(</span><span class=nv>%rdi</span><span class=p>),</span><span class=nv>%zmm0</span>
</code></pre></div> <p>It requires a combination of three instructions to represent</p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x487cf162</span><span class=c1>; WORD $0x4710; BYTE $0x01 // vmovups  64(%rdi), %zmm0</span>
</code></pre></div> <p>Note that the byte order of the instruction encoding and the byte order of the <code>objdump</code> output are reversed.</p> <h4 id=function-definition-and-parameters>Function Definition and Parameters<a class=headerlink href=#function-definition-and-parameters title="Permanent link">&para;</a></h4> <p>In C assembly, if the function has no more than 6 arguments, the arguments are stored in registers and passed to the function in the following order of placement: <code>%rdi</code>, <code>%rsi</code>, <code>%rdx</code>, <code>%rcx</code>, <code>%r8</code> and <code>%r9</code>. However, in Go assembly, function arguments are placed in memory starting from the address held in the <code>FP</code> register, which requires us to move the arguments in memory to the register.</p> <p>The <code>_mm512_mul_to</code> function has four arguments, so it is necessary to move the four arguments before the function starts.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=nf>TEXT</span><span class=w> </span><span class=p>-</span><span class=no>_mm512_mul_to</span><span class=p>(</span><span class=no>SB</span><span class=p>),</span><span class=w> </span><span class=no>$0-32</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=w>  </span><span class=nf>MOVQ</span><span class=w> </span><span class=no>a</span><span class=err>+</span><span class=mi>0</span><span class=p>(</span><span class=no>FP</span><span class=p>),</span><span class=w> </span><span class=no>DI</span>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=w>  </span><span class=nf>MOVQ</span><span class=w> </span><span class=no>b</span><span class=err>+</span><span class=mi>8</span><span class=p>(</span><span class=no>FP</span><span class=p>),</span><span class=w> </span><span class=no>SI</span>
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=w>  </span><span class=nf>MOVQ</span><span class=w> </span><span class=no>c</span><span class=err>+</span><span class=mi>16</span><span class=p>(</span><span class=no>FP</span><span class=p>),</span><span class=w> </span><span class=no>DX</span>
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=w>  </span><span class=nf>MOVQ</span><span class=w> </span><span class=no>n</span><span class=err>+</span><span class=mi>24</span><span class=p>(</span><span class=no>FP</span><span class=p>),</span><span class=w> </span><span class=no>CX</span>
</code></pre></div> <p>The function definition consists of three parts: the <code>TEXT</code> keyword, the name starting with <code>-</code> and ending with <code>(SB)</code>, and finally the parameter memory size of 32 bytes. The information about the number of arguments is not available in assembly and needs to be obtained from the C function definition (refer to <a href=#generate-go-function-definitions>Generating go function definitions</a>).</p> <h4 id=redirect-jump-instruction>Redirect Jump Instruction<a class=headerlink href=#redirect-jump-instruction title="Permanent link">&para;</a></h4> <p>x86 jump instructions jump to absolute addresses and direct encoding of jump instructions does not work. Therefore, jump instructions need to be converted to jump instructions in Go assembly.</p> <ul> <li><strong>Converting tags:</strong> Go assembly tags cannot start with <code>.</code>, so you need to remove the <code>.</code>.</li> <li><strong>Conversion commands:</strong> Go assembly jump commands are in uppercase.</li> </ul> <p>After the above three steps, the final Go assembly code is obtained</p> <p>::: details Go assembly</p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=nf>TEXT</span><span class=w> </span><span class=p>-</span><span class=no>_mm512_mul_to</span><span class=p>(</span><span class=no>SB</span><span class=p>),</span><span class=w> </span><span class=no>$0-32</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=w> </span><span class=nf>MOVQ</span><span class=w> </span><span class=no>a</span><span class=err>+</span><span class=mi>0</span><span class=p>(</span><span class=no>FP</span><span class=p>),</span><span class=w> </span><span class=no>DI</span>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=w> </span><span class=nf>MOVQ</span><span class=w> </span><span class=no>b</span><span class=err>+</span><span class=mi>8</span><span class=p>(</span><span class=no>FP</span><span class=p>),</span><span class=w> </span><span class=no>SI</span>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=w> </span><span class=nf>MOVQ</span><span class=w> </span><span class=no>c</span><span class=err>+</span><span class=mi>16</span><span class=p>(</span><span class=no>FP</span><span class=p>),</span><span class=w> </span><span class=no>DX</span>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=w> </span><span class=nf>MOVQ</span><span class=w> </span><span class=no>n</span><span class=err>+</span><span class=mi>24</span><span class=p>(</span><span class=no>FP</span><span class=p>),</span><span class=w> </span><span class=no>CX</span>
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=w> </span><span class=nf>BYTE</span><span class=w> </span><span class=no>$0x55</span><span class=w> </span><span class=c1>// pushq %rbp</span>
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=w> </span><span class=nf>WORD</span><span class=w> </span><span class=no>$0x8948</span><span class=c1>; BYTE $0xe5 // movq %rsp, %rbp</span>
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0xf8e48348</span><span class=w> </span><span class=c1>// andq $-8, %rsp</span>
<a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x0f498d4c</span><span class=w> </span><span class=c1>// leaq 15(%rcx), %r9</span>
<a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=w> </span><span class=nf>WORD</span><span class=w> </span><span class=no>$0x8548</span><span class=c1>; BYTE $0xc9 // testq %rcx, %rcx</span>
<a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0xc9490f4c</span><span class=w> </span><span class=c1>// cmovnsq %rcx, %r9</span>
<a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x04e9c149</span><span class=w> </span><span class=c1>// shrq $4, %r9</span>
<a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a><span class=w> </span><span class=nf>WORD</span><span class=w> </span><span class=no>$0x8944</span><span class=c1>; BYTE $0xc8 // movl %r9d, %eax</span>
<a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a><span class=w> </span><span class=nf>WORD</span><span class=w> </span><span class=no>$0xe0c1</span><span class=c1>; BYTE $0x04 // shll $4, %eax</span>
<a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a><span class=w> </span><span class=nf>WORD</span><span class=w> </span><span class=no>$0xc129</span><span class=w> </span><span class=c1>// subl %eax, %ecx</span>
<a id=__codelineno-10-16 name=__codelineno-10-16 href=#__codelineno-10-16></a><span class=w> </span><span class=nf>WORD</span><span class=w> </span><span class=no>$0x8545</span><span class=c1>; BYTE $0xc9 // testl %r9d, %r9d</span>
<a id=__codelineno-10-17 name=__codelineno-10-17 href=#__codelineno-10-17></a><span class=w> </span><span class=nf>JLE</span><span class=w> </span><span class=no>LBB3_6</span>
<a id=__codelineno-10-18 name=__codelineno-10-18 href=#__codelineno-10-18></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0xff418d41</span><span class=w> </span><span class=c1>// leal -1(%r9), %eax</span>
<a id=__codelineno-10-19 name=__codelineno-10-19 href=#__codelineno-10-19></a><span class=w> </span><span class=nf>WORD</span><span class=w> </span><span class=no>$0x8945</span><span class=c1>; BYTE $0xc8 // movl %r9d, %r8d</span>
<a id=__codelineno-10-20 name=__codelineno-10-20 href=#__codelineno-10-20></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x03e08341</span><span class=w> </span><span class=c1>// andl $3, %r8d</span>
<a id=__codelineno-10-21 name=__codelineno-10-21 href=#__codelineno-10-21></a><span class=w> </span><span class=nf>WORD</span><span class=w> </span><span class=no>$0xf883</span><span class=c1>; BYTE $0x03 // cmpl $3, %eax</span>
<a id=__codelineno-10-22 name=__codelineno-10-22 href=#__codelineno-10-22></a><span class=w> </span><span class=nf>JB</span><span class=w> </span><span class=no>LBB3_4</span>
<a id=__codelineno-10-23 name=__codelineno-10-23 href=#__codelineno-10-23></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0xfce18341</span><span class=w> </span><span class=c1>// andl $-4, %r9d</span>
<a id=__codelineno-10-24 name=__codelineno-10-24 href=#__codelineno-10-24></a><span class=w> </span><span class=nf>WORD</span><span class=w> </span><span class=no>$0xf741</span><span class=c1>; BYTE $0xd9 // negl %r9d</span>
<a id=__codelineno-10-25 name=__codelineno-10-25 href=#__codelineno-10-25></a>
<a id=__codelineno-10-26 name=__codelineno-10-26 href=#__codelineno-10-26></a><span class=nl>LBB3_3:</span>
<a id=__codelineno-10-27 name=__codelineno-10-27 href=#__codelineno-10-27></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x487cf162</span><span class=c1>; WORD $0x0710 // vmovups (%rdi), %zmm0</span>
<a id=__codelineno-10-28 name=__codelineno-10-28 href=#__codelineno-10-28></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x487cf162</span><span class=c1>; WORD $0x0659 // vmulps (%rsi), %zmm0, %zmm0</span>
<a id=__codelineno-10-29 name=__codelineno-10-29 href=#__codelineno-10-29></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x487cf162</span><span class=c1>; WORD $0x0211 // vmovups %zmm0, (%rdx)</span>
<a id=__codelineno-10-30 name=__codelineno-10-30 href=#__codelineno-10-30></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x487cf162</span><span class=c1>; WORD $0x4710; BYTE $0x01 // vmovups 64(%rdi), %zmm0</span>
<a id=__codelineno-10-31 name=__codelineno-10-31 href=#__codelineno-10-31></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x487cf162</span><span class=c1>; WORD $0x4659; BYTE $0x01 // vmulps 64(%rsi), %zmm0, %zmm0</span>
<a id=__codelineno-10-32 name=__codelineno-10-32 href=#__codelineno-10-32></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x487cf162</span><span class=c1>; WORD $0x4211; BYTE $0x01 // vmovups %zmm0, 64(%rdx)</span>
<a id=__codelineno-10-33 name=__codelineno-10-33 href=#__codelineno-10-33></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x487cf162</span><span class=c1>; WORD $0x4710; BYTE $0x02 // vmovups 128(%rdi), %zmm0</span>
<a id=__codelineno-10-34 name=__codelineno-10-34 href=#__codelineno-10-34></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x487cf162</span><span class=c1>; WORD $0x4659; BYTE $0x02 // vmulps 128(%rsi), %zmm0, %zmm0</span>
<a id=__codelineno-10-35 name=__codelineno-10-35 href=#__codelineno-10-35></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x487cf162</span><span class=c1>; WORD $0x4211; BYTE $0x02 // vmovups %zmm0, 128(%rdx)</span>
<a id=__codelineno-10-36 name=__codelineno-10-36 href=#__codelineno-10-36></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x487cf162</span><span class=c1>; WORD $0x4710; BYTE $0x03 // vmovups 192(%rdi), %zmm0</span>
<a id=__codelineno-10-37 name=__codelineno-10-37 href=#__codelineno-10-37></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x487cf162</span><span class=c1>; WORD $0x4659; BYTE $0x03 // vmulps 192(%rsi), %zmm0, %zmm0</span>
<a id=__codelineno-10-38 name=__codelineno-10-38 href=#__codelineno-10-38></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x487cf162</span><span class=c1>; WORD $0x4211; BYTE $0x03 // vmovups %zmm0, 192(%rdx)</span>
<a id=__codelineno-10-39 name=__codelineno-10-39 href=#__codelineno-10-39></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x00c78148</span><span class=c1>; WORD $0x0001; BYTE $0x00 // addq $256, %rdi</span>
<a id=__codelineno-10-40 name=__codelineno-10-40 href=#__codelineno-10-40></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x00c68148</span><span class=c1>; WORD $0x0001; BYTE $0x00 // addq $256, %rsi</span>
<a id=__codelineno-10-41 name=__codelineno-10-41 href=#__codelineno-10-41></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x00c28148</span><span class=c1>; WORD $0x0001; BYTE $0x00 // addq $256, %rdx</span>
<a id=__codelineno-10-42 name=__codelineno-10-42 href=#__codelineno-10-42></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x04c18341</span><span class=w> </span><span class=c1>// addl $4, %r9d</span>
<a id=__codelineno-10-43 name=__codelineno-10-43 href=#__codelineno-10-43></a><span class=w> </span><span class=nf>JNE</span><span class=w> </span><span class=no>LBB3_3</span>
<a id=__codelineno-10-44 name=__codelineno-10-44 href=#__codelineno-10-44></a>
<a id=__codelineno-10-45 name=__codelineno-10-45 href=#__codelineno-10-45></a><span class=nl>LBB3_4:</span>
<a id=__codelineno-10-46 name=__codelineno-10-46 href=#__codelineno-10-46></a><span class=w> </span><span class=nf>WORD</span><span class=w> </span><span class=no>$0x8545</span><span class=c1>; BYTE $0xc0 // testl %r8d, %r8d</span>
<a id=__codelineno-10-47 name=__codelineno-10-47 href=#__codelineno-10-47></a><span class=w> </span><span class=nf>JE</span><span class=w> </span><span class=no>LBB3_6</span>
<a id=__codelineno-10-48 name=__codelineno-10-48 href=#__codelineno-10-48></a>
<a id=__codelineno-10-49 name=__codelineno-10-49 href=#__codelineno-10-49></a><span class=nl>LBB3_5:</span>
<a id=__codelineno-10-50 name=__codelineno-10-50 href=#__codelineno-10-50></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x487cf162</span><span class=c1>; WORD $0x0710 // vmovups (%rdi), %zmm0</span>
<a id=__codelineno-10-51 name=__codelineno-10-51 href=#__codelineno-10-51></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x487cf162</span><span class=c1>; WORD $0x0659 // vmulps (%rsi), %zmm0, %zmm0</span>
<a id=__codelineno-10-52 name=__codelineno-10-52 href=#__codelineno-10-52></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x487cf162</span><span class=c1>; WORD $0x0211 // vmovups %zmm0, (%rdx)</span>
<a id=__codelineno-10-53 name=__codelineno-10-53 href=#__codelineno-10-53></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x40c78348</span><span class=w> </span><span class=c1>// addq $64, %rdi</span>
<a id=__codelineno-10-54 name=__codelineno-10-54 href=#__codelineno-10-54></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x40c68348</span><span class=w> </span><span class=c1>// addq $64, %rsi</span>
<a id=__codelineno-10-55 name=__codelineno-10-55 href=#__codelineno-10-55></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x40c28348</span><span class=w> </span><span class=c1>// addq $64, %rdx</span>
<a id=__codelineno-10-56 name=__codelineno-10-56 href=#__codelineno-10-56></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0xffc08341</span><span class=w> </span><span class=c1>// addl $-1, %r8d</span>
<a id=__codelineno-10-57 name=__codelineno-10-57 href=#__codelineno-10-57></a><span class=w> </span><span class=nf>JNE</span><span class=w> </span><span class=no>LBB3_5</span>
<a id=__codelineno-10-58 name=__codelineno-10-58 href=#__codelineno-10-58></a>
<a id=__codelineno-10-59 name=__codelineno-10-59 href=#__codelineno-10-59></a><span class=nl>LBB3_6:</span>
<a id=__codelineno-10-60 name=__codelineno-10-60 href=#__codelineno-10-60></a><span class=w> </span><span class=nf>WORD</span><span class=w> </span><span class=no>$0xf983</span><span class=c1>; BYTE $0x07 // cmpl $7, %ecx</span>
<a id=__codelineno-10-61 name=__codelineno-10-61 href=#__codelineno-10-61></a><span class=w> </span><span class=nf>JLE</span><span class=w> </span><span class=no>LBB3_8</span>
<a id=__codelineno-10-62 name=__codelineno-10-62 href=#__codelineno-10-62></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x0710fcc5</span><span class=w> </span><span class=c1>// vmovups (%rdi), %ymm0</span>
<a id=__codelineno-10-63 name=__codelineno-10-63 href=#__codelineno-10-63></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x0659fcc5</span><span class=w> </span><span class=c1>// vmulps (%rsi), %ymm0, %ymm0</span>
<a id=__codelineno-10-64 name=__codelineno-10-64 href=#__codelineno-10-64></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x0211fcc5</span><span class=w> </span><span class=c1>// vmovups %ymm0, (%rdx)</span>
<a id=__codelineno-10-65 name=__codelineno-10-65 href=#__codelineno-10-65></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x20c78348</span><span class=w> </span><span class=c1>// addq $32, %rdi</span>
<a id=__codelineno-10-66 name=__codelineno-10-66 href=#__codelineno-10-66></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x20c68348</span><span class=w> </span><span class=c1>// addq $32, %rsi</span>
<a id=__codelineno-10-67 name=__codelineno-10-67 href=#__codelineno-10-67></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x20c28348</span><span class=w> </span><span class=c1>// addq $32, %rdx</span>
<a id=__codelineno-10-68 name=__codelineno-10-68 href=#__codelineno-10-68></a><span class=w> </span><span class=nf>WORD</span><span class=w> </span><span class=no>$0xc183</span><span class=c1>; BYTE $0xf8 // addl $-8, %ecx</span>
<a id=__codelineno-10-69 name=__codelineno-10-69 href=#__codelineno-10-69></a>
<a id=__codelineno-10-70 name=__codelineno-10-70 href=#__codelineno-10-70></a><span class=nl>LBB3_8:</span>
<a id=__codelineno-10-71 name=__codelineno-10-71 href=#__codelineno-10-71></a><span class=w> </span><span class=nf>WORD</span><span class=w> </span><span class=no>$0xc985</span><span class=w> </span><span class=c1>// testl %ecx, %ecx</span>
<a id=__codelineno-10-72 name=__codelineno-10-72 href=#__codelineno-10-72></a><span class=w> </span><span class=nf>JLE</span><span class=w> </span><span class=no>LBB3_14</span>
<a id=__codelineno-10-73 name=__codelineno-10-73 href=#__codelineno-10-73></a><span class=w> </span><span class=nf>WORD</span><span class=w> </span><span class=no>$0xc989</span><span class=w> </span><span class=c1>// movl %ecx, %ecx</span>
<a id=__codelineno-10-74 name=__codelineno-10-74 href=#__codelineno-10-74></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0xff418d48</span><span class=w> </span><span class=c1>// leaq -1(%rcx), %rax</span>
<a id=__codelineno-10-75 name=__codelineno-10-75 href=#__codelineno-10-75></a><span class=w> </span><span class=nf>WORD</span><span class=w> </span><span class=no>$0x8941</span><span class=c1>; BYTE $0xc8 // movl %ecx, %r8d</span>
<a id=__codelineno-10-76 name=__codelineno-10-76 href=#__codelineno-10-76></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x03e08341</span><span class=w> </span><span class=c1>// andl $3, %r8d</span>
<a id=__codelineno-10-77 name=__codelineno-10-77 href=#__codelineno-10-77></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x03f88348</span><span class=w> </span><span class=c1>// cmpq $3, %rax</span>
<a id=__codelineno-10-78 name=__codelineno-10-78 href=#__codelineno-10-78></a><span class=w> </span><span class=nf>JAE</span><span class=w> </span><span class=no>LBB3_15</span>
<a id=__codelineno-10-79 name=__codelineno-10-79 href=#__codelineno-10-79></a><span class=w> </span><span class=nf>WORD</span><span class=w> </span><span class=no>$0xc031</span><span class=w> </span><span class=c1>// xorl %eax, %eax</span>
<a id=__codelineno-10-80 name=__codelineno-10-80 href=#__codelineno-10-80></a><span class=w> </span><span class=nf>JMP</span><span class=w> </span><span class=no>LBB3_11</span>
<a id=__codelineno-10-81 name=__codelineno-10-81 href=#__codelineno-10-81></a>
<a id=__codelineno-10-82 name=__codelineno-10-82 href=#__codelineno-10-82></a><span class=nl>LBB3_15:</span>
<a id=__codelineno-10-83 name=__codelineno-10-83 href=#__codelineno-10-83></a><span class=w> </span><span class=nf>WORD</span><span class=w> </span><span class=no>$0xe183</span><span class=c1>; BYTE $0xfc // andl $-4, %ecx</span>
<a id=__codelineno-10-84 name=__codelineno-10-84 href=#__codelineno-10-84></a><span class=w> </span><span class=nf>WORD</span><span class=w> </span><span class=no>$0xc031</span><span class=w> </span><span class=c1>// xorl %eax, %eax</span>
<a id=__codelineno-10-85 name=__codelineno-10-85 href=#__codelineno-10-85></a>
<a id=__codelineno-10-86 name=__codelineno-10-86 href=#__codelineno-10-86></a><span class=nl>LBB3_16:</span>
<a id=__codelineno-10-87 name=__codelineno-10-87 href=#__codelineno-10-87></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x0410fac5</span><span class=c1>; BYTE $0x87 // vmovss (%rdi,%rax,4), %xmm0</span>
<a id=__codelineno-10-88 name=__codelineno-10-88 href=#__codelineno-10-88></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x0459fac5</span><span class=c1>; BYTE $0x86 // vmulss (%rsi,%rax,4), %xmm0, %xmm0</span>
<a id=__codelineno-10-89 name=__codelineno-10-89 href=#__codelineno-10-89></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x0411fac5</span><span class=c1>; BYTE $0x82 // vmovss %xmm0, (%rdx,%rax,4)</span>
<a id=__codelineno-10-90 name=__codelineno-10-90 href=#__codelineno-10-90></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x4410fac5</span><span class=c1>; WORD $0x0487 // vmovss 4(%rdi,%rax,4), %xmm0</span>
<a id=__codelineno-10-91 name=__codelineno-10-91 href=#__codelineno-10-91></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x4459fac5</span><span class=c1>; WORD $0x0486 // vmulss 4(%rsi,%rax,4), %xmm0, %xmm0</span>
<a id=__codelineno-10-92 name=__codelineno-10-92 href=#__codelineno-10-92></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x4411fac5</span><span class=c1>; WORD $0x0482 // vmovss %xmm0, 4(%rdx,%rax,4)</span>
<a id=__codelineno-10-93 name=__codelineno-10-93 href=#__codelineno-10-93></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x4410fac5</span><span class=c1>; WORD $0x0887 // vmovss 8(%rdi,%rax,4), %xmm0</span>
<a id=__codelineno-10-94 name=__codelineno-10-94 href=#__codelineno-10-94></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x4459fac5</span><span class=c1>; WORD $0x0886 // vmulss 8(%rsi,%rax,4), %xmm0, %xmm0</span>
<a id=__codelineno-10-95 name=__codelineno-10-95 href=#__codelineno-10-95></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x4411fac5</span><span class=c1>; WORD $0x0882 // vmovss %xmm0, 8(%rdx,%rax,4)</span>
<a id=__codelineno-10-96 name=__codelineno-10-96 href=#__codelineno-10-96></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x4410fac5</span><span class=c1>; WORD $0x0c87 // vmovss 12(%rdi,%rax,4), %xmm0</span>
<a id=__codelineno-10-97 name=__codelineno-10-97 href=#__codelineno-10-97></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x4459fac5</span><span class=c1>; WORD $0x0c86 // vmulss 12(%rsi,%rax,4), %xmm0, %xmm0</span>
<a id=__codelineno-10-98 name=__codelineno-10-98 href=#__codelineno-10-98></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x4411fac5</span><span class=c1>; WORD $0x0c82 // vmovss %xmm0, 12(%rdx,%rax,4)</span>
<a id=__codelineno-10-99 name=__codelineno-10-99 href=#__codelineno-10-99></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x04c08348</span><span class=w> </span><span class=c1>// addq $4, %rax</span>
<a id=__codelineno-10-100 name=__codelineno-10-100 href=#__codelineno-10-100></a><span class=w> </span><span class=nf>WORD</span><span class=w> </span><span class=no>$0x3948</span><span class=c1>; BYTE $0xc1 // cmpq %rax, %rcx</span>
<a id=__codelineno-10-101 name=__codelineno-10-101 href=#__codelineno-10-101></a><span class=w> </span><span class=nf>JNE</span><span class=w> </span><span class=no>LBB3_16</span>
<a id=__codelineno-10-102 name=__codelineno-10-102 href=#__codelineno-10-102></a>
<a id=__codelineno-10-103 name=__codelineno-10-103 href=#__codelineno-10-103></a><span class=nl>LBB3_11:</span>
<a id=__codelineno-10-104 name=__codelineno-10-104 href=#__codelineno-10-104></a><span class=w> </span><span class=nf>WORD</span><span class=w> </span><span class=no>$0x854d</span><span class=c1>; BYTE $0xc0 // testq %r8, %r8</span>
<a id=__codelineno-10-105 name=__codelineno-10-105 href=#__codelineno-10-105></a><span class=w> </span><span class=nf>JE</span><span class=w> </span><span class=no>LBB3_14</span>
<a id=__codelineno-10-106 name=__codelineno-10-106 href=#__codelineno-10-106></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x820c8d48</span><span class=w> </span><span class=c1>// leaq (%rdx,%rax,4), %rcx</span>
<a id=__codelineno-10-107 name=__codelineno-10-107 href=#__codelineno-10-107></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x86148d48</span><span class=w> </span><span class=c1>// leaq (%rsi,%rax,4), %rdx</span>
<a id=__codelineno-10-108 name=__codelineno-10-108 href=#__codelineno-10-108></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x87048d48</span><span class=w> </span><span class=c1>// leaq (%rdi,%rax,4), %rax</span>
<a id=__codelineno-10-109 name=__codelineno-10-109 href=#__codelineno-10-109></a><span class=w> </span><span class=nf>WORD</span><span class=w> </span><span class=no>$0xf631</span><span class=w> </span><span class=c1>// xorl %esi, %esi</span>
<a id=__codelineno-10-110 name=__codelineno-10-110 href=#__codelineno-10-110></a>
<a id=__codelineno-10-111 name=__codelineno-10-111 href=#__codelineno-10-111></a><span class=nl>LBB3_13:</span>
<a id=__codelineno-10-112 name=__codelineno-10-112 href=#__codelineno-10-112></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x0410fac5</span><span class=c1>; BYTE $0xb0 // vmovss (%rax,%rsi,4), %xmm0</span>
<a id=__codelineno-10-113 name=__codelineno-10-113 href=#__codelineno-10-113></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x0459fac5</span><span class=c1>; BYTE $0xb2 // vmulss (%rdx,%rsi,4), %xmm0, %xmm0</span>
<a id=__codelineno-10-114 name=__codelineno-10-114 href=#__codelineno-10-114></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x0411fac5</span><span class=c1>; BYTE $0xb1 // vmovss %xmm0, (%rcx,%rsi,4)</span>
<a id=__codelineno-10-115 name=__codelineno-10-115 href=#__codelineno-10-115></a><span class=w> </span><span class=nf>LONG</span><span class=w> </span><span class=no>$0x01c68348</span><span class=w> </span><span class=c1>// addq $1, %rsi</span>
<a id=__codelineno-10-116 name=__codelineno-10-116 href=#__codelineno-10-116></a><span class=w> </span><span class=nf>WORD</span><span class=w> </span><span class=no>$0x3949</span><span class=c1>; BYTE $0xf0 // cmpq %rsi, %r8</span>
<a id=__codelineno-10-117 name=__codelineno-10-117 href=#__codelineno-10-117></a><span class=w> </span><span class=nf>JNE</span><span class=w> </span><span class=no>LBB3_13</span>
<a id=__codelineno-10-118 name=__codelineno-10-118 href=#__codelineno-10-118></a>
<a id=__codelineno-10-119 name=__codelineno-10-119 href=#__codelineno-10-119></a><span class=nl>LBB3_14:</span>
<a id=__codelineno-10-120 name=__codelineno-10-120 href=#__codelineno-10-120></a><span class=w> </span><span class=nf>WORD</span><span class=w> </span><span class=no>$0x8948</span><span class=c1>; BYTE $0xec // movq %rbp, %rsp</span>
<a id=__codelineno-10-121 name=__codelineno-10-121 href=#__codelineno-10-121></a><span class=w> </span><span class=nf>BYTE</span><span class=w> </span><span class=no>$0x5d</span><span class=w> </span><span class=c1>// popq %rbp</span>
<a id=__codelineno-10-122 name=__codelineno-10-122 href=#__codelineno-10-122></a><span class=w> </span><span class=nf>WORD</span><span class=w> </span><span class=no>$0xf8c5</span><span class=c1>; BYTE $0x77 // vzeroupper</span>
<a id=__codelineno-10-123 name=__codelineno-10-123 href=#__codelineno-10-123></a><span class=w> </span><span class=nf>BYTE</span><span class=w> </span><span class=no>$0xc3</span><span class=w> </span><span class=c1>// retq</span>
</code></pre></div> <p>:::</p> <h3 id=generate-go-function-definitions>Generate Go Function Definitions<a class=headerlink href=#generate-go-function-definitions title="Permanent link">&para;</a></h3> <p>Converting C function definitions to Go functions requires a C parser. <a href=https://gitlab.com/cznic>cznic</a> implements a C-to-Go converter in Go <a href=https://pkg.go.dev/modernc.org/cc/v3>cc/v3</a> which provides a C parser. The function definition conversion consists of two parts.</p> <ul> <li><strong>Function name:</strong> Directly use the function name of the C function as the Go function name</li> <li><strong>Function arguments:</strong> Need to check that function arguments must be of the 64-bit type, passed in Go functions using <code>unsafe.Pointer</code></li> </ul> <p>The definition of the <code>_mm512_mul_to</code> conversion to a Go function is as follows</p> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=kn>import</span><span class=w> </span><span class=s>&quot;unsafe&quot;</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=c1>//go:noescape</span>
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=kd>func</span><span class=w> </span><span class=nx>_mm512_mul_to</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span><span class=w> </span><span class=nx>b</span><span class=p>,</span><span class=w> </span><span class=nx>c</span><span class=p>,</span><span class=w> </span><span class=nx>n</span><span class=w> </span><span class=nx>unsafe</span><span class=p>.</span><span class=nx>Pointer</span><span class=p>)</span>
</code></pre></div> <h2 id=build-with-go-generate>Build with <code>go generate</code><a class=headerlink href=#build-with-go-generate title="Permanent link">&para;</a></h2> <p>For generated code, the <code>go generate</code> command can run custom commands to do conversions from C functions to Go functions. gorse added the <code>go generate</code> command to the <a href=https://github.com/gorse-io/gorse/blob/release-0.4/base/floats/floats_amd64.go>floats_amd64.go</a> file, which executes <code>go generate . /...</code> to automatically generate Go vectorized functions.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=c1>//go:generate go run ... /... /cmd/goat src/floats_avx.c -O3 -mavx</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=c1>//go:generate go run ... /... /cmd/goat src/floats_avx512.c -O3 -mavx -mfma -mavx512f -mavx512dq</span>
</code></pre></div> <h2 id=function-calls>Function Calls<a class=headerlink href=#function-calls title="Permanent link">&para;</a></h2> <p>Calling the vectorized function is not a simple task, because only new CPUs support AVX512, and some older CPUs do not even support AVX2, which requires the following steps when calling the vectorized function.</p> <ol> <li>Provide a non-vectorized function implementation for CPUs that do not support AVX512.</li> <li>Detect in the <code>init</code> function whether the currently running CPU supports AVX512.</li> <li>Wrapping an outer function automatically selects a vectorized or non-vectorized function depending on CPU instruction support.</li> </ol> <p>The complete wrapper is as follows</p> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=kn>import</span><span class=w> </span><span class=p>(</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=w> </span><span class=s>&quot;github.com/klauspost/cpuid/v2&quot;</span>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=w> </span><span class=s>&quot;unsafe&quot;</span>
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=p>)</span>
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>
<a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=c1>// CPU instruction flag</span>
<a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=kd>var</span><span class=w> </span><span class=nx>impl</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>Default</span>
<a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a>
<a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a><span class=kd>const</span><span class=w> </span><span class=p>(</span>
<a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a><span class=w> </span><span class=nx>Default</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=kc>iota</span>
<a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a><span class=w> </span><span class=nx>AVX512</span>
<a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a><span class=p>)</span>
<a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a>
<a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a><span class=kd>func</span><span class=w> </span><span class=nx>init</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a><span class=w> </span><span class=c1>// Check if the CPU supports AVX512</span>
<a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a><span class=w> </span><span class=k>if</span><span class=w> </span><span class=nx>cpuid</span><span class=p>.</span><span class=nx>CPU</span><span class=p>.</span><span class=nx>Supports</span><span class=p>(</span><span class=nx>cpuid</span><span class=p>.</span><span class=nx>AVX512F</span><span class=p>,</span><span class=w> </span><span class=nx>cpuid</span><span class=p>.</span><span class=nx>AVX512DQ</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-13-17 name=__codelineno-13-17 href=#__codelineno-13-17></a><span class=w>  </span><span class=nx>impl</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>AVX512</span>
<a id=__codelineno-13-18 name=__codelineno-13-18 href=#__codelineno-13-18></a><span class=w> </span><span class=p>}</span>
<a id=__codelineno-13-19 name=__codelineno-13-19 href=#__codelineno-13-19></a><span class=p>}</span>
<a id=__codelineno-13-20 name=__codelineno-13-20 href=#__codelineno-13-20></a>
<a id=__codelineno-13-21 name=__codelineno-13-21 href=#__codelineno-13-21></a><span class=c1>// Non-vectorized implementation</span>
<a id=__codelineno-13-22 name=__codelineno-13-22 href=#__codelineno-13-22></a><span class=kd>func</span><span class=w> </span><span class=nx>mulTo</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span><span class=w> </span><span class=nx>b</span><span class=p>,</span><span class=w> </span><span class=nx>c</span><span class=w> </span><span class=p>[]</span><span class=kt>float32</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-13-23 name=__codelineno-13-23 href=#__codelineno-13-23></a><span class=w> </span><span class=k>for</span><span class=w> </span><span class=nx>i</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=k>range</span><span class=w> </span><span class=nx>a</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-13-24 name=__codelineno-13-24 href=#__codelineno-13-24></a><span class=w>  </span><span class=nx>c</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>a</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=nx>b</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span>
<a id=__codelineno-13-25 name=__codelineno-13-25 href=#__codelineno-13-25></a><span class=w> </span><span class=p>}</span>
<a id=__codelineno-13-26 name=__codelineno-13-26 href=#__codelineno-13-26></a><span class=p>}</span>
<a id=__codelineno-13-27 name=__codelineno-13-27 href=#__codelineno-13-27></a>
<a id=__codelineno-13-28 name=__codelineno-13-28 href=#__codelineno-13-28></a><span class=c1>// Wrapper functions</span>
<a id=__codelineno-13-29 name=__codelineno-13-29 href=#__codelineno-13-29></a><span class=kd>func</span><span class=w> </span><span class=nx>MulTo</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span><span class=w> </span><span class=nx>b</span><span class=p>,</span><span class=w> </span><span class=nx>c</span><span class=w> </span><span class=p>[]</span><span class=kt>float32</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-13-30 name=__codelineno-13-30 href=#__codelineno-13-30></a><span class=w> </span><span class=k>if</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span><span class=w> </span><span class=p>!</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=nx>b</span><span class=p>)</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=nx>a</span><span class=p>)</span><span class=w> </span><span class=p>!</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=nx>c</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-13-31 name=__codelineno-13-31 href=#__codelineno-13-31></a><span class=w>  </span><span class=nb>panic</span><span class=p>(</span><span class=s>&quot;floats: slice lengths do not match&quot;</span><span class=p>)</span>
<a id=__codelineno-13-32 name=__codelineno-13-32 href=#__codelineno-13-32></a><span class=w> </span><span class=p>}</span>
<a id=__codelineno-13-33 name=__codelineno-13-33 href=#__codelineno-13-33></a><span class=w> </span><span class=c1>// Automatic selection of functions for execution</span>
<a id=__codelineno-13-34 name=__codelineno-13-34 href=#__codelineno-13-34></a><span class=w> </span><span class=k>switch</span><span class=w> </span><span class=nx>impl</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-13-35 name=__codelineno-13-35 href=#__codelineno-13-35></a><span class=w> </span><span class=k>case</span><span class=w> </span><span class=nx>AVX512</span><span class=p>:</span>
<a id=__codelineno-13-36 name=__codelineno-13-36 href=#__codelineno-13-36></a><span class=w>  </span><span class=nx>_mm512_mul_to</span><span class=p>(</span><span class=nx>unsafe</span><span class=p>.</span><span class=nx>Pointer</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>a</span><span class=p>[</span><span class=mi>0</span><span class=p>]),</span><span class=w> </span><span class=nx>unsafe</span><span class=p>.</span><span class=nx>Pointer</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>b</span><span class=p>[</span><span class=mi>0</span><span class=p>]),</span><span class=w> </span><span class=nx>unsafe</span><span class=p>.</span><span class=nx>Pointer</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>c</span><span class=p>[</span><span class=mi>0</span><span class=p>]),</span><span class=w> </span><span class=nx>unsafe</span><span class=p>.</span><span class=nx>Pointer</span><span class=p>(</span><span class=nb>uintptr</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>a</span><span class=p>))))</span>
<a id=__codelineno-13-37 name=__codelineno-13-37 href=#__codelineno-13-37></a><span class=w> </span><span class=k>default</span><span class=p>:</span>
<a id=__codelineno-13-38 name=__codelineno-13-38 href=#__codelineno-13-38></a><span class=w>  </span><span class=nx>mulTo</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span><span class=w> </span><span class=nx>b</span><span class=p>,</span><span class=w> </span><span class=nx>c</span><span class=p>)</span>
<a id=__codelineno-13-39 name=__codelineno-13-39 href=#__codelineno-13-39></a><span class=w> </span><span class=p>}</span>
<a id=__codelineno-13-40 name=__codelineno-13-40 href=#__codelineno-13-40></a><span class=p>}</span>
</code></pre></div> <p>::: note</p> <p>Go assembly should be saved in a file with the <code>.s</code> extension and the Go definition and wrapper should be saved in Go files. They must be in the same directory with the same package name.</p> <p>:::</p> <h2 id=summary>Summary<a class=headerlink href=#summary title="Permanent link">&para;</a></h2> <p>Finally, we benchmark the performance of the non-vectorized function and the vectorized function.</p> <ul> <li>Vectorized functions take significantly less time than non-vectorized functions, especially when the vector length is 128.</li> <li>The AVX512 implementation has a slight performance increase relative to the AVX2 implementation.</li> </ul> <p>::: echarts Vectorized Implementation Performance Benchmark</p> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=p>{</span>
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=w>  </span><span class=nt>&quot;legend&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=w>    </span><span class=nt>&quot;data&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;SISD&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;AVX2&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;AVX512&quot;</span><span class=p>]</span>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=w>  </span><span class=p>},</span>
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=w>  </span><span class=nt>&quot;xAxis&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a><span class=w>    </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;vector-length&quot;</span><span class=p>,</span>
<a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a><span class=w>    </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;category&quot;</span><span class=p>,</span>
<a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a><span class=w>    </span><span class=nt>&quot;data&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=mi>16</span><span class=p>,</span><span class=w> </span><span class=mi>32</span><span class=p>,</span><span class=w> </span><span class=mi>64</span><span class=p>,</span><span class=w> </span><span class=mi>128</span><span class=p>]</span>
<a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a><span class=w>  </span><span class=p>},</span>
<a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a><span class=w>  </span><span class=nt>&quot;yAxis&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a><span class=w>    </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;ns/op&quot;</span><span class=p>,</span>
<a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a><span class=w>    </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;value&quot;</span>
<a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a><span class=w>  </span><span class=p>},</span>
<a id=__codelineno-14-14 name=__codelineno-14-14 href=#__codelineno-14-14></a><span class=w>  </span><span class=nt>&quot;series&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<a id=__codelineno-14-15 name=__codelineno-14-15 href=#__codelineno-14-15></a><span class=w>    </span><span class=p>{</span>
<a id=__codelineno-14-16 name=__codelineno-14-16 href=#__codelineno-14-16></a><span class=w>      </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;SISD&quot;</span><span class=p>,</span>
<a id=__codelineno-14-17 name=__codelineno-14-17 href=#__codelineno-14-17></a><span class=w>      </span><span class=nt>&quot;data&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=mf>10.56</span><span class=p>,</span><span class=w> </span><span class=mf>23.13</span><span class=p>,</span><span class=w> </span><span class=mf>38.01</span><span class=p>,</span><span class=w> </span><span class=mf>67.05</span><span class=p>],</span>
<a id=__codelineno-14-18 name=__codelineno-14-18 href=#__codelineno-14-18></a><span class=w>      </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;bar&quot;</span><span class=p>,</span>
<a id=__codelineno-14-19 name=__codelineno-14-19 href=#__codelineno-14-19></a><span class=w>      </span><span class=nt>&quot;showBackground&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=p>,</span>
<a id=__codelineno-14-20 name=__codelineno-14-20 href=#__codelineno-14-20></a><span class=w>      </span><span class=nt>&quot;backgroundStyle&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-14-21 name=__codelineno-14-21 href=#__codelineno-14-21></a><span class=w>        </span><span class=nt>&quot;color&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;rgba(180, 180, 180, 0.2)&quot;</span>
<a id=__codelineno-14-22 name=__codelineno-14-22 href=#__codelineno-14-22></a><span class=w>      </span><span class=p>}</span>
<a id=__codelineno-14-23 name=__codelineno-14-23 href=#__codelineno-14-23></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-14-24 name=__codelineno-14-24 href=#__codelineno-14-24></a><span class=w>    </span><span class=p>{</span>
<a id=__codelineno-14-25 name=__codelineno-14-25 href=#__codelineno-14-25></a><span class=w>      </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;AVX2&quot;</span><span class=p>,</span>
<a id=__codelineno-14-26 name=__codelineno-14-26 href=#__codelineno-14-26></a><span class=w>      </span><span class=nt>&quot;data&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=mf>5.046</span><span class=p>,</span><span class=w> </span><span class=mf>5.138</span><span class=p>,</span><span class=w> </span><span class=mf>6.074</span><span class=p>,</span><span class=w> </span><span class=mf>8.294</span><span class=p>],</span>
<a id=__codelineno-14-27 name=__codelineno-14-27 href=#__codelineno-14-27></a><span class=w>      </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;bar&quot;</span><span class=p>,</span>
<a id=__codelineno-14-28 name=__codelineno-14-28 href=#__codelineno-14-28></a><span class=w>      </span><span class=nt>&quot;showBackground&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=p>,</span>
<a id=__codelineno-14-29 name=__codelineno-14-29 href=#__codelineno-14-29></a><span class=w>      </span><span class=nt>&quot;backgroundStyle&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-14-30 name=__codelineno-14-30 href=#__codelineno-14-30></a><span class=w>        </span><span class=nt>&quot;color&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;rgba(180, 180, 180, 0.2)&quot;</span>
<a id=__codelineno-14-31 name=__codelineno-14-31 href=#__codelineno-14-31></a><span class=w>      </span><span class=p>}</span>
<a id=__codelineno-14-32 name=__codelineno-14-32 href=#__codelineno-14-32></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-14-33 name=__codelineno-14-33 href=#__codelineno-14-33></a><span class=w>    </span><span class=p>{</span>
<a id=__codelineno-14-34 name=__codelineno-14-34 href=#__codelineno-14-34></a><span class=w>      </span><span class=nt>&quot;name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;AVX512&quot;</span><span class=p>,</span>
<a id=__codelineno-14-35 name=__codelineno-14-35 href=#__codelineno-14-35></a><span class=w>      </span><span class=nt>&quot;data&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=mf>4.741</span><span class=p>,</span><span class=w> </span><span class=mf>5.417</span><span class=p>,</span><span class=w> </span><span class=mf>5.583</span><span class=p>,</span><span class=w> </span><span class=mf>6.425</span><span class=p>],</span>
<a id=__codelineno-14-36 name=__codelineno-14-36 href=#__codelineno-14-36></a><span class=w>      </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;bar&quot;</span><span class=p>,</span>
<a id=__codelineno-14-37 name=__codelineno-14-37 href=#__codelineno-14-37></a><span class=w>      </span><span class=nt>&quot;showBackground&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=p>,</span>
<a id=__codelineno-14-38 name=__codelineno-14-38 href=#__codelineno-14-38></a><span class=w>      </span><span class=nt>&quot;backgroundStyle&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-14-39 name=__codelineno-14-39 href=#__codelineno-14-39></a><span class=w>        </span><span class=nt>&quot;color&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;rgba(180, 180, 180, 0.2)&quot;</span>
<a id=__codelineno-14-40 name=__codelineno-14-40 href=#__codelineno-14-40></a><span class=w>      </span><span class=p>}</span>
<a id=__codelineno-14-41 name=__codelineno-14-41 href=#__codelineno-14-41></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-14-42 name=__codelineno-14-42 href=#__codelineno-14-42></a><span class=w>  </span><span class=p>]</span>
<a id=__codelineno-14-43 name=__codelineno-14-43 href=#__codelineno-14-43></a><span class=p>}</span>
</code></pre></div> <p>:::</p> <p>In addition, the SIMD instructions Neon for ARM can also be used in Go by the idea of this post. goat also supports ARM, and Gorse also implements vectorized computation libraries for Neon instructions (refer to <a href=https://github.com/gorse-io/gorse/tree/master/base/floats>github.com/gorse-io/gorse/base/floats</a>). You are welcome to use goat to build your own vectorized functions in Go projects, more questions are welcome in <a href=https://github.com/gorse-io/gorse/issues>Issues</a> or <a href=https://discord.gg/x6gAtNNkAE>Discord</a>.</p> <h2 id=__comments>Comments</h2> <!-- Insert generated snippet here --> <script src=https://giscus.app/client.js data-repo=crossdb-org/docs data-repo-id=R_kgDOHf96fA data-category=Announcements data-category-id=DIC_kwDOHf96fM4CWGDD data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=light data-lang=en crossorigin=anonymous async>
</script> <!-- Synchronize Giscus theme with palette --> <script>
    var giscus = document.querySelector("script[src*=giscus]")

    /* Set palette on initial load */
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate" ? "dark" : "light"
      giscus.setAttribute("data-theme", theme) 
    }

    /* Register event handlers after documented loaded */
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "slate" ? "dark" : "light"

          /* Instruct Giscus to change theme */
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script> </article> </div> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2023 CrossDB | <a href=/about/terms>Terms</a> | <a href=/about/privacy>Privacy</a> | <a href=/about/refund>Refund</a> | <a href=/about/about>About</a> | <span id=busuanzi_container_page_pv>View <span id=busuanzi_value_page_pv></span> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/crossdb-org/crossdb target=_blank rel=noopener title=Github class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://twitter.com/CrossDbOrg target=_blank rel=noopener title=Twitter class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> <a href=mailto:support@crossdb.org target=_blank rel=noopener title class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l217.6 163.2c11.4 8.5 27 8.5 38.4 0l217.6-163.2c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48H48zM0 176v208c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V176L294.4 339.2a63.9 63.9 0 0 1-76.8 0L0 176z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["content.code.annotate", "content.code.copy", "content.tooltips", "navigation.indexes", "navigation.footer", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.fac441b0.min.js></script> <script src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script> <script src=../../../assets/javascripts/baidu-tongji.js></script> </body> </html>